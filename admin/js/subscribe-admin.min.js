!function(){"use strict";function t(t,e){var o=t.querySelector(".podloom-subscribe-podcast__count");o&&(o.textContent=e+(1===e?" link":" links"))}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".podloom-subscribe-podcast__toggle").forEach(function(t){t.addEventListener("click",function(){var t="true"===this.getAttribute("aria-expanded"),e=this.closest(".podloom-subscribe-podcast").querySelector(".podloom-subscribe-podcast__content");this.setAttribute("aria-expanded",!t),e&&(t?(e.style.display="none",e.setAttribute("aria-hidden","true")):(e.style.display="block",e.setAttribute("aria-hidden","false")))})}),document.querySelectorAll(".podloom-save-subscribe-links").forEach(function(e){e.addEventListener("click",function(){var o=this.closest(".podloom-subscribe-podcast"),n=o.dataset.sourceId,s=o.querySelectorAll(".podloom-subscribe-link__input"),a=o.querySelector(".podloom-save-status"),r={},c=podloomData.strings||{};s.forEach(function(t){var e=t.dataset.platform,o=t.value.trim();o&&(r[e]=o)}),e.disabled=!0,e.textContent=c.saving||"Saving...",a.textContent="",a.className="podloom-save-status";var i=new FormData;i.append("action","podloom_save_subscribe_links"),i.append("nonce",podloomData.nonce),i.append("source_id",n),i.append("links",JSON.stringify(r)),fetch(podloomData.ajaxUrl,{method:"POST",body:i}).then(function(t){return t.json()}).then(function(e){e.success?(a.textContent=c.saved||"Saved!",a.className="podloom-save-status success",t(o,Object.keys(r).length)):(a.textContent=e.data||c.error||"Error saving",a.className="podloom-save-status error")}).catch(function(){a.textContent=c.error||"Error saving",a.className="podloom-save-status error"}).finally(function(){e.disabled=!1,e.textContent=c.saveLinks||"Save Links"})})}),document.querySelectorAll(".podloom-sync-transistor").forEach(function(e){e.addEventListener("click",function(){var o=this.dataset.showId,n=this.closest(".podloom-subscribe-podcast"),s=n.querySelector(".podloom-sync-status"),a=podloomData.strings||{};e.disabled=!0;var r=e.innerHTML;e.innerHTML='<span class="dashicons dashicons-update spinning"></span> '+(a.syncing||"Syncing..."),s.textContent="",s.className="podloom-sync-status";var c=new FormData;c.append("action","podloom_sync_transistor_links"),c.append("nonce",podloomData.nonce),c.append("show_id",o),fetch(podloomData.ajaxUrl,{method:"POST",body:c}).then(function(t){return t.json()}).then(function(e){if(e.success){var o=e.data.links||{};n.querySelectorAll(".podloom-subscribe-link__input").forEach(function(t){var e=t.dataset.platform;o[e]&&(t.value=o[e])}),s.textContent=(a.synced||"Synced!")+" ("+Object.keys(o).length+" links)",s.className="podloom-sync-status success",t(n,Object.keys(o).length)}else s.textContent=e.data||a.error||"Error syncing",s.className="podloom-sync-status error"}).catch(function(){s.textContent=a.error||"Error syncing",s.className="podloom-sync-status error"}).finally(function(){e.disabled=!1,e.innerHTML=r})})})});var e=document.createElement("style");e.textContent="@keyframes podloom-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } .dashicons.spinning { animation: podloom-spin 1s linear infinite; }",document.head.appendChild(e)}();