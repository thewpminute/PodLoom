!function(){"use strict";function t(t,o){var e=t.querySelector(".podloom-subscribe-podcast__count");e&&(e.textContent=o+(1===o?" link":" links"))}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".podloom-subscribe-podcast__toggle").forEach(function(t){t.addEventListener("click",function(){var t="true"===this.getAttribute("aria-expanded"),o=this.closest(".podloom-subscribe-podcast").querySelector(".podloom-subscribe-podcast__content");this.setAttribute("aria-expanded",!t),o&&(o.style.display=t?"none":"block")})}),document.querySelectorAll(".podloom-save-subscribe-links").forEach(function(o){o.addEventListener("click",function(){var e=this.closest(".podloom-subscribe-podcast"),n=e.dataset.sourceId,s=e.querySelectorAll(".podloom-subscribe-link__input"),a=e.querySelector(".podloom-save-status"),r={},c=podloomData.strings||{};s.forEach(function(t){var o=t.dataset.platform,e=t.value.trim();e&&(r[o]=e)}),o.disabled=!0,o.textContent=c.saving||"Saving...",a.textContent="",a.className="podloom-save-status";var i=new FormData;i.append("action","podloom_save_subscribe_links"),i.append("nonce",podloomData.nonce),i.append("source_id",n),i.append("links",JSON.stringify(r)),fetch(podloomData.ajaxUrl,{method:"POST",body:i}).then(function(t){return t.json()}).then(function(o){o.success?(a.textContent=c.saved||"Saved!",a.className="podloom-save-status success",t(e,Object.keys(r).length)):(a.textContent=o.data||c.error||"Error saving",a.className="podloom-save-status error")}).catch(function(){a.textContent=c.error||"Error saving",a.className="podloom-save-status error"}).finally(function(){o.disabled=!1,o.textContent=c.saveLinks||"Save Links"})})}),document.querySelectorAll(".podloom-sync-transistor").forEach(function(o){o.addEventListener("click",function(){var e=this.dataset.showId,n=this.closest(".podloom-subscribe-podcast"),s=n.querySelector(".podloom-sync-status"),a=podloomData.strings||{};o.disabled=!0;var r=o.innerHTML;o.innerHTML='<span class="dashicons dashicons-update spinning"></span> '+(a.syncing||"Syncing..."),s.textContent="",s.className="podloom-sync-status";var c=new FormData;c.append("action","podloom_sync_transistor_links"),c.append("nonce",podloomData.nonce),c.append("show_id",e),fetch(podloomData.ajaxUrl,{method:"POST",body:c}).then(function(t){return t.json()}).then(function(o){if(o.success){var e=o.data.links||{};n.querySelectorAll(".podloom-subscribe-link__input").forEach(function(t){var o=t.dataset.platform;e[o]&&(t.value=e[o])}),s.textContent=(a.synced||"Synced!")+" ("+Object.keys(e).length+" links)",s.className="podloom-sync-status success",t(n,Object.keys(e).length)}else s.textContent=o.data||a.error||"Error syncing",s.className="podloom-sync-status error"}).catch(function(){s.textContent=a.error||"Error syncing",s.className="podloom-sync-status error"}).finally(function(){o.disabled=!1,o.innerHTML=r})})})});var o=document.createElement("style");o.textContent="@keyframes podloom-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } .dashicons.spinning { animation: podloom-spin 1s linear infinite; }",document.head.appendChild(o)}();