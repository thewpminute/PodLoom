!function(){"use strict";var t=null;function e(e){var a=(t||((t=document.createElement("div")).setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="podloom-sr-announcer",t.style.cssText="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;",document.body.appendChild(t)),t);a.textContent="",setTimeout(function(){a.textContent=e},50)}function a(t,e){const a=t.querySelectorAll(".chapter-item");let r=null;a.forEach(function(t){const a=parseFloat(t.getAttribute("data-start-time"));!isNaN(a)&&e>=a&&(r=t)}),a.forEach(function(t){t.classList.remove("active"),t.removeAttribute("aria-current")}),r&&(r.classList.add("active"),r.setAttribute("aria-current","true"));const n=t.closest(".rss-episode-player");if(n){const t=n.querySelector(".rss-episode-artwork img");if(t){let e=null;if(r){const t=r.querySelector(".chapter-img");t&&(e=t.src)}if(e)t.src!==e&&(t.src=e);else{const e=t.getAttribute("data-original-src");e&&t.src!==e&&(t.src=e)}}}}function r(t,a,s,l){var p=l.closest(".transcript-viewer");if(a>=t.length){s.classList.remove("loading"),s.removeAttribute("aria-busy"),p&&p.removeAttribute("aria-busy");const e=(t[0].url||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return void(l.innerHTML='<div class="transcript-error" role="alert">Could not load transcript. <a href="'+e+'" target="_blank" rel="noopener noreferrer">Open in new tab</a></div>')}const u=t[a],f=u.url,m=u.type||"text/plain",h="undefined"!=typeof podloomTranscript&&podloomTranscript.ajaxUrl?podloomTranscript.ajaxUrl+"?action=podloom_fetch_transcript&url="+encodeURIComponent(f):f;fetch(h).then(function(t){return t.json().then(function(e){if(!t.ok){const a=e.data&&e.data.message?e.data.message:"HTTP "+t.status;throw console.error("Transcript proxy error ("+t.status+"):",a,"URL:",f),new Error(a)}return e})}).then(function(t){if(!(t.success&&t.data&&t.data.content))throw new Error(t.data?t.data.message:"Failed to load transcript");{const a=function(t,e){var a=t.trim();if(a.startsWith("<!DOCTYPE")||a.startsWith("<html")||a.includes("<body")&&a.includes("</body>"))return i(t);if(e.includes("html"))return i(t);if(e.includes("srt"))return o(t);if(e.includes("vtt"))return function(t){return t=t.replace(/^WEBVTT\s*\n/,""),o(t)}(t);if(e.includes("json"))return function(t){try{var e=JSON.parse(t),a="";return e.segments&&Array.isArray(e.segments)&&e.segments.forEach(function(t){void 0!==t.startTime&&t.body&&(a+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+c(t.startTime)+"</span>"+d(t.body)+"</p>")}),a||"<p>No transcript content found.</p>"}catch(t){return'<p class="transcript-error">Invalid JSON format.</p>'}}(t);if(e.includes("text/plain")||e.includes("text/txt")||e.includes(".txt"))return n(t);return n(t)}(t.data.content,m);l.innerHTML=a,s.classList.remove("loading"),s.classList.add("active"),s.removeAttribute("aria-busy"),s.setAttribute("aria-expanded","true"),p&&p.removeAttribute("aria-busy"),function(t){var a=t.querySelectorAll(".transcript-timestamp"),r=t.closest(".podcast20-transcripts"),n=r?r.closest(".rss-episode-player"):null;if(!n)return;var i=n.querySelector("audio");if(!i)return;a.forEach(function(t){function a(){var a=parseFloat(t.getAttribute("data-time"));isNaN(a)||(i.currentTime=a,i.paused&&i.play().catch(function(t){console.warn("Could not auto-play audio:",t)}),e("Seeking to "+t.textContent))}t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.addEventListener("click",a),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a())})})}(l),e("Transcript loaded")}}).catch(function(e){console.warn("Transcript load failed for "+f+", trying next format...",e),r(t,a+1,s,l)})}function n(t){var e=t.trim().split(/\n\s*\n/),a="";return e.forEach(function(t){t.trim()&&(a+="<p>"+d(t.trim().replace(/\n/g,"<br>"))+"</p>")}),a||"<p>"+d(t)+"</p>"}function i(t){for(var e=(new DOMParser).parseFromString(t,"text/html"),a=document.createElement("div"),r=[".transcript",".transcript-content",".episode-transcript","[data-transcript]","article","main",".content",".episode-content"],n=null,i=0;i<r.length&&!(n=e.querySelector(r[i]));i++);if(n)a.appendChild(n.cloneNode(!0));else{e.body&&Array.from(e.body.childNodes).forEach(function(t){a.appendChild(t.cloneNode(!0))});["header","nav","footer",".header",".navigation",".nav",".footer",".sidebar",".menu",".social",'[role="navigation"]','[role="banner"]','[role="complementary"]'].forEach(function(t){a.querySelectorAll(t).forEach(function(t){t.remove()})})}return["script","iframe","object","embed","link","style","form"].forEach(function(t){a.querySelectorAll(t).forEach(function(t){t.remove()})}),a.querySelectorAll("*").forEach(function(t){if(Array.from(t.attributes).forEach(function(e){(e.name.startsWith("on")||"style"===e.name)&&t.removeAttribute(e.name)}),t.hasAttribute("href")){var e=t.getAttribute("href");e&&(e.toLowerCase().startsWith("javascript:")||e.toLowerCase().startsWith("data:"))&&t.removeAttribute("href")}}),a.querySelectorAll("[data-time], [data-timestamp]").forEach(function(t){t.classList.contains("transcript-timestamp")||t.classList.add("transcript-timestamp"),t.hasAttribute("data-timestamp")&&!t.hasAttribute("data-time")&&t.setAttribute("data-time",t.getAttribute("data-timestamp"))}),function(t){var e,a=[],r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;e=r.nextNode();)e.textContent.trim()&&a.push(e);return a}(a).forEach(function(t){for(var e,a=t.textContent,r=/[\[\(]?(\d{1,2}):(\d{2})(?::(\d{2}))?[\]\)]?/g,n=[];null!==(e=r.exec(a));){var i;if(e[3])i=3600*parseInt(e[1],10)+60*parseInt(e[2],10)+parseInt(e[3],10);else i=60*parseInt(e[1],10)+parseInt(e[2],10);i<86400&&n.push({match:e[0],index:e.index,time:i})}if(n.length>0){var o=document.createDocumentFragment(),s=0;n.forEach(function(t){t.index>s&&o.appendChild(document.createTextNode(a.substring(s,t.index)));var e=document.createElement("span");e.className="transcript-timestamp",e.setAttribute("data-time",t.time),e.textContent=t.match,o.appendChild(e),s=t.index+t.match.length}),s<a.length&&o.appendChild(document.createTextNode(a.substring(s))),t.parentNode&&t.parentNode.replaceChild(o,t)}}),a.innerHTML}function o(t){var e=t.trim().split(/\n\s*\n/),a=[];if(e.forEach(function(t){var e=t.split("\n");if(!(e.length<3)){var r=e[1].split(" --\x3e ");if(!(r.length<2)){var n=s(r[0]),i=s(r[1]),o=e.slice(2).join(" ").trim();!isNaN(n)&&o&&a.push({startTime:n,endTime:i,text:o})}}}),0===a.length)return"<p>No transcript content found.</p>";var r=[],n=null;a.forEach(function(t,e){var i=e>0?a[e-1]:null,o=i?t.startTime-i.endTime:0;!n||o>=3?(n&&r.push(n),n={startTime:t.startTime,texts:[t.text]}):n.texts.push(t.text)}),n&&r.push(n);var i="";return r.forEach(function(t){var e=t.texts.join(" ");i+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+c(t.startTime)+"</span> "+d(e)+"</p>"}),i}function s(t){var e=t.split(":");return 3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseFloat(e[2].replace(",","."))}function c(t){var e=Math.floor(t/3600),a=Math.floor(t%3600/60),r=Math.floor(t%60);return e>0?e+":"+l(a)+":"+l(r):a+":"+l(r)}function l(t){return t<10?"0"+t:t}function d(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}function p(){document.querySelectorAll(".rss-playlist-player").forEach(function(t){if(!t.hasAttribute("data-playlist-initialized")){t.setAttribute("data-playlist-initialized","true");var a=t.querySelector(".podloom-playlist-data");if(a){var n;try{n=JSON.parse(a.textContent)}catch(t){return void console.error("PodLoom: Failed to parse playlist data",t)}if(n&&0!==n.length){var i=t.querySelector(".podloom-playlist-audio"),o=t.querySelector(".podloom-playlist-artwork"),s=t.querySelector(".podloom-playlist-title"),c=t.querySelector(".podloom-playlist-date"),l=t.querySelector(".podloom-playlist-duration"),d=t.querySelector(".podloom-episodes-list");if(i&&d){var p=0,u=t.getAttribute("data-feed-id")||"",f=parseInt(t.getAttribute("data-total-episodes")||n.length,10),m=function(t,e,a){var r=[],n=e.slice(),i=!1,o=n.length<a,s=n.length;function c(){if(i||!o)return Promise.resolve([]);if(r.length>=10)return Promise.resolve([]);i=!0;var e="undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl?podloomPlaylist.ajaxUrl:"undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",a="undefined"!=typeof podloomPlaylist&&podloomPlaylist.nonce?podloomPlaylist.nonce:"";return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=podloom_get_rss_episodes_public&feed_id="+encodeURIComponent(t)+"&offset="+s+"&limit=20&nonce="+encodeURIComponent(a)}).then(function(t){return t.json()}).then(function(t){if(i=!1,t.success&&t.data&&t.data.episodes){var e=t.data.episodes;return r=r.concat(e),s+=e.length,o=t.data.has_more,e}return[]}).catch(function(){return i=!1,[]})}return o&&setTimeout(c,1e3),{getMore:function(t){if(t=t||10,r.length>=t){var e=r.splice(0,t);return n=n.concat(e),r.length<10&&o&&c(),Promise.resolve(e)}return c().then(function(){if(r.length>0){var e=r.splice(0,Math.min(t,r.length));return n=n.concat(e),e}return[]})},hasMore:function(){return o||r.length>0},getDisplayed:function(){return n},isLoading:function(){return i}}}(u,n,f);d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){function a(){var e=parseInt(t.getAttribute("data-episode-index"),10);isNaN(e)||e===p?e===p&&i.paused&&i.play().catch(function(t){console.warn("PodLoom: Could not play",t)}):T(e)}t.style.cursor="pointer",t.setAttribute("role","button"),t.setAttribute("tabindex","0"),0===e&&t.setAttribute("aria-current","true"),t.addEventListener("click",a),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a())})}),i.addEventListener("ended",function(){var t=p+1;t<n.length&&T(t)}),i.addEventListener("timeupdate",function(){var e=t.querySelector(".podloom-playlist-chapters .podcast20-chapters-list");if(e){var a=e.querySelectorAll(".chapter-item"),r=i.currentTime,n=null;if(a.forEach(function(t){var e=parseFloat(t.getAttribute("data-start-time"));!isNaN(e)&&r>=e&&(n=t)}),a.forEach(function(t){t.classList.remove("active")}),n&&n.classList.add("active"),o){var s=null;if(n){var c=n.querySelector(".chapter-img");c&&(s=c.src)}if(s)o.src!==s&&(o.src=s);else{var l=o.getAttribute("data-original-src");l&&o.src!==l&&(o.src=l)}}}});var h=!1;d.addEventListener("scroll",function(){!h&&m.hasMore()&&(d.scrollHeight-d.scrollTop-d.clientHeight<200&&(h=!0,m.getMore(10).then(function(t){t.length>0&&function(t){t.forEach(function(t,e){var a=n.length;n.push(t);var r=document.createElement("div");r.className="podloom-episode-item",r.setAttribute("data-episode-index",a),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.style.cursor="pointer";var o=document.createElement("div");o.className="podloom-episode-thumb",t.image?o.innerHTML='<img src="'+w(t.image)+'" alt="'+w(t.title||"")+'" loading="lazy">':o.classList.add("podloom-episode-thumb-placeholder");var s=document.createElement("div");s.className="podloom-episode-play-overlay",s.innerHTML='<span class="podloom-play-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>',o.appendChild(s);var c=document.createElement("div");c.className="podloom-episode-info";var l=document.createElement("div");l.className="podloom-episode-title-row",l.innerHTML='<div class="podloom-episode-item-title">'+w(t.title||"")+"</div>",c.appendChild(l);var u=document.createElement("div");u.className="podloom-episode-meta-row",t.date&&(u.innerHTML+='<span class="podloom-episode-item-date">'+g(t.date)+"</span>"),t.duration&&(u.innerHTML+='<span class="podloom-episode-item-duration">'+v(t.duration)+"</span>"),c.appendChild(u),r.appendChild(o),r.appendChild(c),d.appendChild(r),r.addEventListener("click",function(){a!==p?T(a):i.paused&&i.play().catch(function(){})}),r.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),r.click())})})}(t),h=!1})))})}}}else console.warn("PodLoom: No playlist data found")}function v(t){if(!t||isNaN(t))return"";t=parseInt(t,10);var e=Math.floor(t/3600),a=Math.floor(t%3600/60),r=t%60;return e>0?e+":"+y(a)+":"+y(r):a+":"+y(r)}function y(t){return t<10?"0"+t:t}function g(t){return t?new Date(1e3*t).toLocaleDateString():""}function b(t){if(!t||0===t.length)return'<p class="no-content">No chapters available for this episode.</p>';var e='<div class="podcast20-chapters-list">';return e+='<h4 class="chapters-heading">Chapters</h4>',t.forEach(function(t){var a=t.startTime||0,r=v(a),n=w(t.title||"");e+='<div class="chapter-item" data-start-time="'+a+'">',t.img?e+='<img src="'+w(t.img)+'" alt="'+n+'" class="chapter-img" loading="lazy" />':e+='<div class="chapter-img-placeholder"></div>',e+='<div class="chapter-info">',e+='<button class="chapter-timestamp" data-start-time="'+a+'">'+r+"</button>",e+='<span class="chapter-title">'+n,t.url&&(e+=' <a href="'+w(t.url)+'" target="_blank" rel="noopener noreferrer" class="chapter-external-link" title="Open chapter link">',e+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block; vertical-align: middle; margin-left: 4px;">',e+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',e+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',e+="</svg></a>"),e+="</span>",e+="</div>",e+="</div>"}),e+="</div>"}function L(t){if(!t||0===t.length)return'<p class="no-content">No credits available for this episode.</p>';var e='<div class="podcast20-people">';return e+='<h4 class="podcast20-heading">Credits</h4>',e+='<div class="podcast20-people-list">',t.forEach(function(t){if(t.name){var a=w(t.name),r=t.role?w(t.role):"";e+='<div class="podcast20-person">',t.img?e+='<img src="'+w(t.img)+'" alt="'+a+'" class="podcast20-person-img">':(e+='<div class="podcast20-person-avatar">',e+='<svg width="40" height="40" viewBox="0 0 16 16" fill="currentColor">',e+='<path d="M11 6a3 3 0 11-6 0 3 3 0 016 0z"/>',e+='<path d="M2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2zm12 1a1 1 0 011 1v12a1 1 0 01-1 1v-1c0-1-1-4-6-4s-6 3-6 4v1a1 1 0 01-1-1V2a1 1 0 011-1h12z"/>',e+="</svg></div>"),e+='<div class="podcast20-person-info">',r&&(e+='<span class="podcast20-person-role">'+r.charAt(0).toUpperCase()+r.slice(1)+"</span>"),t.href?e+='<a href="'+w(t.href)+'" target="_blank" rel="noopener noreferrer" class="podcast20-person-name">'+a+"</a>":e+='<span class="podcast20-person-name">'+a+"</span>",e+="</div>",e+="</div>"}}),e+="</div>",e+="</div>"}function A(t){if(!t||0===t.length)return'<p class="no-content">No transcript available for this episode.</p>';var e={"text/html":1,"application/x-subrip":2,"text/srt":2,"text/vtt":3,"application/json":4,"text/plain":5};t.sort(function(t,a){return(e[t.type]||999)-(e[a.type]||999)});var a=t[0],r=JSON.stringify(t),n='<div class="podcast20-transcripts">';return n+='<div class="transcript-formats">',n+='<button class="transcript-format-button" data-url="'+w(a.url)+'" data-type="'+w(a.type||"text/plain")+"\" data-transcripts='"+w(r).replace(/'/g,"&#39;")+"'>",n+='<svg class="podcast20-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">',n+='<path d="M14 4.5V14a2 2 0 01-2 2H4a2 2 0 01-2-2V2a2 2 0 012-2h5.5L14 4.5zm-3 0A1.5 1.5 0 019.5 3V1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4.5h-2z"/>',n+='<path d="M3 9.5h10v1H3v-1zm0 2h10v1H3v-1z"/>',n+="</svg>",n+="<span>Click for Transcript</span>",n+="</button>",n+=' <a href="'+w(a.url)+'" target="_blank" rel="noopener noreferrer" class="transcript-external-link" title="Open transcript in new tab">',n+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">',n+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',n+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',n+="</svg></a>",n+="</div>",n+='<div class="transcript-viewer" style="display: none;">',n+='<div class="transcript-content"></div>',n+='<button class="transcript-close">Close</button>',n+="</div>",n+="</div>"}function x(t,e){t.querySelectorAll(".chapter-item").forEach(function(t){t.style.cursor="pointer",t.addEventListener("click",function(a){if(!a.target.closest(".chapter-external-link")){a.preventDefault();var r=parseFloat(t.getAttribute("data-start-time"));isNaN(r)||(e.currentTime=r,e.paused&&e.play().catch(function(t){console.warn("PodLoom: Could not auto-play",t)}))}})})}function E(t){t.querySelectorAll(".transcript-format-button").forEach(function(t){t.addEventListener("click",function(){var e,a=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),n=a.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),a.style.display="none",void(n.innerHTML="");try{e=JSON.parse(t.getAttribute("data-transcripts"))}catch(t){e=[]}0!==e.length&&(t.classList.add("loading"),a.style.display="block",n.innerHTML='<div class="transcript-loading">Loading transcript...</div>',r(e,0,t,n))})}),t.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){var e=t.closest(".transcript-viewer"),a=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),r=e.querySelector(".transcript-content");a.classList.remove("active"),e.style.display="none",r.innerHTML=""})})}function S(t,e,a){if("undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl){var r=new XMLHttpRequest;r.open("POST",podloomPlaylist.ajaxUrl,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status)try{var t=JSON.parse(r.responseText);t.success&&t.data?a(t.data):a(null)}catch(t){a(null)}else a(null)},r.send("action=podloom_get_episode_p20&feed_id="+encodeURIComponent(t)+"&episode_id="+encodeURIComponent(e)+"&nonce="+encodeURIComponent(podloomPlaylist.nonce||""))}else a(null)}function T(a){if(!(a<0||a>=n.length)){var r=n[a];p=a;var f,m=i.querySelector("source");m?m.src=r.audio_url:i.src=r.audio_url,i.load(),i.play().catch(function(t){console.warn("PodLoom: Could not auto-play episode",t)}),function(t){s&&t.title&&(s.textContent=t.title),c&&t.date&&(c.textContent=g(t.date)),l&&t.duration&&(l.textContent=v(t.duration)),o&&t.image&&(o.src=t.image,o.alt=t.title||"",o.setAttribute("data-original-src",t.image))}(r),f=a,d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){var a=t.querySelector(".podloom-episode-play-overlay");a&&(e===f?(t.classList.add("podloom-episode-current"),t.setAttribute("aria-current","true"),a.innerHTML='<span class="podloom-now-playing-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite"/></rect><rect x="10" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="8;16;8" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="8;4;8" dur="0.8s" repeatCount="indefinite"/></rect><rect x="16" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite" begin="0.2s"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite" begin="0.2s"/></rect></svg></span>'):(t.classList.remove("podloom-episode-current"),t.removeAttribute("aria-current"),a.innerHTML='<span class="podloom-play-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>'))}),function(e){var a=t.querySelector('[data-tab-id="description"]');if(a){var r=a.querySelector(".podloom-playlist-description");if(r){var n=e.content||e.description||"";r.innerHTML=n}}var o=e.podcast20,s=t.querySelector('[data-tab-id="chapters"]');if(s){var c=s.querySelector(".podloom-playlist-chapters");if(c){var l=o&&o.chapters&&o.chapters.chapters?o.chapters.chapters:null;l&&l.length>0?(c.innerHTML=b(l),x(c,i)):u&&e.id?S(u,e.id,function(t){var e=t&&t.chapters&&t.chapters.chapters?t.chapters.chapters:null;e&&e.length>0?(c.innerHTML=b(e),x(c,i)):c.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}):c.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}}var d=t.querySelector('[data-tab-id="credits"]');if(d){var p=d.querySelector(".podloom-playlist-credits");if(p)if(o&&(o.people_channel&&o.people_channel.length>0||o.people_episode&&o.people_episode.length>0)){var f=[];o.people_channel&&(f=f.concat(o.people_channel)),o.people_episode&&(f=f.concat(o.people_episode)),p.innerHTML=L(f)}else u&&e.id?S(u,e.id,function(t){if(t){var e=[];t.people_channel&&(e=e.concat(t.people_channel)),t.people_episode&&(e=e.concat(t.people_episode)),e.length>0?p.innerHTML=L(e):p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}else p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}):p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}var m=t.querySelector('[data-tab-id="transcripts"]');if(m){var h=m.querySelector(".podloom-playlist-transcripts");h&&(o&&o.transcripts&&o.transcripts.length>0?(h.innerHTML=A(o.transcripts),E(h)):u&&e.id?S(u,e.id,function(t){t&&t.transcripts&&t.transcripts.length>0?(h.innerHTML=A(t.transcripts),E(h)):h.innerHTML='<p class="no-content">No transcript available for this episode.</p>'}):h.innerHTML='<p class="no-content">No transcript available for this episode.</p>')}}(r);var h=d.querySelector('[data-episode-index="'+a+'"]');h&&h.scrollIntoView({behavior:"smooth",block:"nearest"}),e("Now playing: "+(r.title||"Episode "+(a+1)))}}function w(t){if(!t)return"";var e=document.createElement("div");return e.textContent=t,e.innerHTML}})}function u(){"undefined"!=typeof podloomImageCache&&podloomImageCache.ajaxUrl&&fetch(podloomImageCache.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=podloom_process_image_cache"}).then(function(t){return t.json()}).then(function(t){t.success&&t.data.remaining>0&&setTimeout(u,1e3)}).catch(function(){})}function f(){!function(){function t(t,e,a,r){const n=t.getAttribute("data-tab");e.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1")}),a.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-hidden","true")}),t.classList.add("active"),t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0");const i=r.querySelector("#tab-panel-"+n);i&&(i.classList.add("active"),i.setAttribute("aria-hidden","false"))}document.querySelectorAll(".podcast20-tabs").forEach(function(e){const a=e.querySelectorAll(".podcast20-tab-button"),r=e.querySelectorAll(".podcast20-tab-panel");r.forEach(function(t){t.classList.contains("active")?t.setAttribute("aria-hidden","false"):t.setAttribute("aria-hidden","true")}),a.forEach(function(t,e){t.setAttribute("tabindex",t.classList.contains("active")?"0":"-1")}),a.forEach(function(n,i){n.addEventListener("click",function(){t(n,a,r,e)}),n.addEventListener("keydown",function(n){let o=-1;const s=i;"ArrowRight"===n.key||"ArrowDown"===n.key?(n.preventDefault(),o=(s+1)%a.length):"ArrowLeft"===n.key||"ArrowUp"===n.key?(n.preventDefault(),o=(s-1+a.length)%a.length):"Home"===n.key?(n.preventDefault(),o=0):"End"===n.key&&(n.preventDefault(),o=a.length-1),o>=0&&(a[o].focus(),t(a[o],a,r,e))})})})}(),document.querySelectorAll(".podcast20-chapters-list").forEach(function(t){const r=t.closest(".rss-episode-player");if(!r)return void console.warn("PodLoom: Chapter list found but no episode container");const n=r.querySelector("audio");if(!n)return void console.warn("PodLoom: Chapter list found but no audio player in episode container");const i=r.querySelector(".rss-episode-artwork img");i&&(i.hasAttribute("data-original-src")||i.setAttribute("data-original-src",i.src)),t.querySelectorAll(".chapter-item").forEach(function(r){function i(i){if("A"===i.target.tagName&&i.target.classList.contains("chapter-external-link"))return;if(i.target.closest(".chapter-external-link"))return;i.preventDefault();const o=parseFloat(r.getAttribute("data-start-time"));isNaN(o)||(n.currentTime=o,n.paused&&n.play().catch(function(t){console.warn("PodLoom: Could not auto-play audio:",t)}),a(t,o),e("Playing chapter: "+(r.querySelector(".chapter-title")?.textContent||"")))}r.style.cursor="pointer",r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.addEventListener("click",i),r.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i(t))})}),n.addEventListener("timeupdate",function(){const e=n.currentTime;a(t,e)})}),document.querySelectorAll(".transcript-format-button").forEach(function(t){t.setAttribute("aria-expanded","false"),t.addEventListener("click",function(){const e=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),a=e.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),t.setAttribute("aria-expanded","false"),e.style.display="none",void(a.innerHTML="");let n;try{const e=t.getAttribute("data-transcripts");n=JSON.parse(e)}catch(e){n=[{url:t.getAttribute("data-url"),type:t.getAttribute("data-type")||"text/plain"}]}t.classList.add("loading"),t.setAttribute("aria-busy","true"),e.style.display="block",e.setAttribute("aria-busy","true"),a.innerHTML='<div class="transcript-loading" role="status">Loading transcript...</div>',r(n,0,t,a)})}),document.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){const e=t.closest(".transcript-viewer"),a=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),r=e.querySelector(".transcript-content");a.classList.remove("active"),a.setAttribute("aria-expanded","false"),e.style.display="none",r.innerHTML="",a.focus()})}),document.querySelectorAll(".podloom-skip-btn").forEach(function(t){t.hasAttribute("data-initialized")||(t.setAttribute("data-initialized","true"),t.addEventListener("click",function(){var e=parseInt(t.getAttribute("data-skip"),10),a=t.closest(".rss-episode-player");if(a){var r=a.querySelector("audio");if(r){var n=r.currentTime+e;n=Math.max(0,Math.min(n,r.duration||1/0)),r.currentTime=n}}}))}),p(),document.querySelectorAll(".podloom-player-container").forEach(function(t){if(!t.hasAttribute("data-player-initialized")){t.setAttribute("data-player-initialized","true");var e=t.querySelector(".podloom-audio-element");if(e){e.setAttribute("aria-hidden","true"),e.removeAttribute("controls"),e.setAttribute("tabindex","-1"),t.podloomAudio=e;var a=t.querySelector(".podloom-play-toggle"),r=t.querySelector(".podloom-timeline-container"),n=t.querySelector(".podloom-timeline-progress"),i=t.querySelector(".podloom-timeline-slider"),o=t.querySelector(".podloom-current-time"),s=t.querySelector(".podloom-duration"),l=t.querySelector(".podloom-speed-btn"),d=[1,1.25,1.5,2],p=0;a&&a.addEventListener("click",function(){e.paused?e.play().catch(function(t){console.warn("PodLoom: Could not play audio",t)}):e.pause()}),e.addEventListener("play",function(){t.classList.add("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-pause-label")||"Pause")}),e.addEventListener("pause",function(){t.classList.remove("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-play-label")||"Play")}),e.addEventListener("ended",function(){t.classList.remove("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-play-label")||"Play")}),e.addEventListener("timeupdate",function(){var t=e.currentTime,a=e.duration||0;if(o&&(o.textContent=c(t)),a>0&&n){var r=t/a*100;n.style.width=r+"%"}a>0&&i&&(i.value=t)}),e.addEventListener("loadedmetadata",function(){s&&(s.textContent=c(e.duration)),i&&(i.max=e.duration)}),e.addEventListener("durationchange",function(){s&&e.duration&&isFinite(e.duration)&&(s.textContent=c(e.duration)),i&&e.duration&&isFinite(e.duration)&&(i.max=e.duration)}),i&&i.addEventListener("input",function(){var t=parseFloat(i.value);isNaN(t)||(e.currentTime=t)}),r&&r.addEventListener("click",function(t){var a=r.getBoundingClientRect(),n=(t.clientX-a.left)/a.width*(e.duration||0);!isNaN(n)&&isFinite(n)&&(e.currentTime=n)}),l&&l.addEventListener("click",function(){var t=d[p=(p+1)%d.length];e.playbackRate=t,l.textContent=t+"x"})}}}),document.querySelectorAll(".podloom-player-container:not(.podloom-ready), .rss-playlist-player:not(.podloom-ready)").forEach(function(t){t.classList.add("podloom-ready")}),setTimeout(u,500)}if("loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f(),void 0!==window.MutationObserver){new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&t.addedNodes.forEach(function(t){1===t.nodeType&&(t.classList&&(t.classList.contains("podcast20-tabs")||t.classList.contains("podcast20-chapters-list")||t.classList.contains("rss-playlist-player")||t.classList.contains("podloom-player-container"))||t.querySelector&&(t.querySelector(".podcast20-tabs")||t.querySelector(".podcast20-chapters-list")||t.querySelector(".rss-playlist-player")||t.querySelector(".podloom-player-container")))&&f()})})}).observe(document.body,{childList:!0,subtree:!0})}function m(t){"podloomNodeInserted"===t.animationName&&(t.target.classList.contains("podloom-ready")||f())}document.addEventListener("animationstart",m,!1),document.addEventListener("webkitAnimationStart",m,!1)}();