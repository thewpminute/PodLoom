!function(){"use strict";var t=null;function e(e){var r=(t||((t=document.createElement("div")).setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="podloom-sr-announcer",t.style.cssText="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;",document.body.appendChild(t)),t);r.textContent="",setTimeout(function(){r.textContent=e},50)}function r(t,e){const r=t.querySelectorAll(".chapter-item");let a=null;r.forEach(function(t){const r=parseFloat(t.getAttribute("data-start-time"));!isNaN(r)&&e>=r&&(a=t)}),r.forEach(function(t){t.classList.remove("active"),t.removeAttribute("aria-current")}),a&&(a.classList.add("active"),a.setAttribute("aria-current","true"));const n=t.closest(".rss-episode-player");if(n){const t=n.querySelector(".rss-episode-artwork img");if(t){let e=null;if(a){const t=a.querySelector(".chapter-img");t&&(e=t.src)}if(e)t.src!==e&&(t.src=e);else{const e=t.getAttribute("data-original-src");e&&t.src!==e&&(t.src=e)}}}}function a(t,r,s,l){var u=l.closest(".transcript-viewer");if(r>=t.length){s.classList.remove("loading"),s.removeAttribute("aria-busy"),u&&u.removeAttribute("aria-busy");const e=(t[0].url||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return void(l.innerHTML='<div class="transcript-error" role="alert">Could not load transcript. <a href="'+e+'" target="_blank" rel="noopener noreferrer">Open in new tab</a></div>')}const p=t[r],f=p.url,h=p.type||"text/plain",m="undefined"!=typeof podloomTranscript&&podloomTranscript.ajaxUrl?podloomTranscript.ajaxUrl+"?action=podloom_fetch_transcript&url="+encodeURIComponent(f):f;fetch(m).then(function(t){return t.json().then(function(e){if(!t.ok){const r=e.data&&e.data.message?e.data.message:"HTTP "+t.status;throw console.error("Transcript proxy error ("+t.status+"):",r,"URL:",f),new Error(r)}return e})}).then(function(t){if(!(t.success&&t.data&&t.data.content))throw new Error(t.data?t.data.message:"Failed to load transcript");{const r=function(t,e){var r=t.trim();if(r.startsWith("<!DOCTYPE")||r.startsWith("<html")||r.includes("<body")&&r.includes("</body>"))return i(t);if(e.includes("html"))return i(t);if(e.includes("srt"))return o(t);if(e.includes("vtt"))return function(t){return t=t.replace(/^WEBVTT\s*\n/,""),o(t)}(t);if(e.includes("json"))return function(t){try{var e=JSON.parse(t),r="";return e.segments&&Array.isArray(e.segments)&&e.segments.forEach(function(t){void 0!==t.startTime&&t.body&&(r+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+c(t.startTime)+"</span>"+d(t.body)+"</p>")}),r||"<p>No transcript content found.</p>"}catch(t){return'<p class="transcript-error">Invalid JSON format.</p>'}}(t);if(e.includes("text/plain")||e.includes("text/txt")||e.includes(".txt"))return n(t);return n(t)}(t.data.content,h);l.innerHTML=r,s.classList.remove("loading"),s.classList.add("active"),s.removeAttribute("aria-busy"),s.setAttribute("aria-expanded","true"),u&&u.removeAttribute("aria-busy"),function(t){var r=t.querySelectorAll(".transcript-timestamp"),a=t.closest(".podcast20-transcripts"),n=a?a.closest(".rss-episode-player"):null;if(!n)return;var i=n.querySelector("audio");if(!i)return;r.forEach(function(t){function r(){var r=parseFloat(t.getAttribute("data-time"));isNaN(r)||(i.currentTime=r,i.paused&&i.play().catch(function(t){console.warn("Could not auto-play audio:",t)}),e("Seeking to "+t.textContent))}t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.addEventListener("click",r),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),r())})})}(l),e("Transcript loaded")}}).catch(function(e){console.warn("Transcript load failed for "+f+", trying next format...",e),a(t,r+1,s,l)})}function n(t){var e=t.trim().split(/\n\s*\n/),r="";return e.forEach(function(t){t.trim()&&(r+="<p>"+d(t.trim().replace(/\n/g,"<br>"))+"</p>")}),r||"<p>"+d(t)+"</p>"}function i(t){for(var e=(new DOMParser).parseFromString(t,"text/html"),r=document.createElement("div"),a=[".transcript",".transcript-content",".episode-transcript","[data-transcript]","article","main",".content",".episode-content"],n=null,i=0;i<a.length&&!(n=e.querySelector(a[i]));i++);if(n)r.appendChild(n.cloneNode(!0));else{e.body&&Array.from(e.body.childNodes).forEach(function(t){r.appendChild(t.cloneNode(!0))});["header","nav","footer",".header",".navigation",".nav",".footer",".sidebar",".menu",".social",'[role="navigation"]','[role="banner"]','[role="complementary"]'].forEach(function(t){r.querySelectorAll(t).forEach(function(t){t.remove()})})}return["script","iframe","object","embed","link","style","form"].forEach(function(t){r.querySelectorAll(t).forEach(function(t){t.remove()})}),r.querySelectorAll("*").forEach(function(t){if(Array.from(t.attributes).forEach(function(e){(e.name.startsWith("on")||"style"===e.name)&&t.removeAttribute(e.name)}),t.hasAttribute("href")){var e=t.getAttribute("href");e&&(e.toLowerCase().startsWith("javascript:")||e.toLowerCase().startsWith("data:"))&&t.removeAttribute("href")}}),r.querySelectorAll("[data-time], [data-timestamp]").forEach(function(t){t.classList.contains("transcript-timestamp")||t.classList.add("transcript-timestamp"),t.hasAttribute("data-timestamp")&&!t.hasAttribute("data-time")&&t.setAttribute("data-time",t.getAttribute("data-timestamp"))}),function(t){var e,r=[],a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;e=a.nextNode();)e.textContent.trim()&&r.push(e);return r}(r).forEach(function(t){for(var e,r=t.textContent,a=/[\[\(]?(\d{1,2}):(\d{2})(?::(\d{2}))?[\]\)]?/g,n=[];null!==(e=a.exec(r));){var i;if(e[3])i=3600*parseInt(e[1],10)+60*parseInt(e[2],10)+parseInt(e[3],10);else i=60*parseInt(e[1],10)+parseInt(e[2],10);i<86400&&n.push({match:e[0],index:e.index,time:i})}if(n.length>0){var o=document.createDocumentFragment(),s=0;n.forEach(function(t){t.index>s&&o.appendChild(document.createTextNode(r.substring(s,t.index)));var e=document.createElement("span");e.className="transcript-timestamp",e.setAttribute("data-time",t.time),e.textContent=t.match,o.appendChild(e),s=t.index+t.match.length}),s<r.length&&o.appendChild(document.createTextNode(r.substring(s))),t.parentNode&&t.parentNode.replaceChild(o,t)}}),r.innerHTML}function o(t){var e=t.trim().split(/\n\s*\n/),r=[];if(e.forEach(function(t){var e=t.split("\n");if(!(e.length<3)){var a=e[1].split(" --\x3e ");if(!(a.length<2)){var n=s(a[0]),i=s(a[1]),o=e.slice(2).join(" ").trim();!isNaN(n)&&o&&r.push({startTime:n,endTime:i,text:o})}}}),0===r.length)return"<p>No transcript content found.</p>";var a=[],n=null;r.forEach(function(t,e){var i=e>0?r[e-1]:null,o=i?t.startTime-i.endTime:0;!n||o>=3?(n&&a.push(n),n={startTime:t.startTime,texts:[t.text]}):n.texts.push(t.text)}),n&&a.push(n);var i="";return a.forEach(function(t){var e=t.texts.join(" ");i+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+c(t.startTime)+"</span> "+d(e)+"</p>"}),i}function s(t){var e=t.split(":");return 3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseFloat(e[2].replace(",","."))}function c(t){var e=Math.floor(t/3600),r=Math.floor(t%3600/60),a=Math.floor(t%60);return e>0?e+":"+l(r)+":"+l(a):r+":"+l(a)}function l(t){return t<10?"0"+t:t}function d(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}function u(){document.querySelectorAll(".rss-playlist-player").forEach(function(t){if(!t.hasAttribute("data-playlist-initialized")){t.setAttribute("data-playlist-initialized","true");var r=t.querySelector(".podloom-playlist-data");if(r){var n;try{n=JSON.parse(r.textContent)}catch(t){return void console.error("PodLoom: Failed to parse playlist data",t)}if(n&&0!==n.length){var i=t.querySelector(".podloom-playlist-audio"),o=t.querySelector(".podloom-playlist-artwork"),s=t.querySelector(".podloom-playlist-title"),c=t.querySelector(".podloom-playlist-date"),l=t.querySelector(".podloom-playlist-duration"),d=t.querySelector(".podloom-episodes-list");if(i&&d){var u=0,p=t.getAttribute("data-feed-id")||"";d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){function r(){var e=parseInt(t.getAttribute("data-episode-index"),10);isNaN(e)||e===u?e===u&&i.paused&&i.play().catch(function(t){console.warn("PodLoom: Could not play",t)}):x(e)}t.style.cursor="pointer",t.setAttribute("role","button"),t.setAttribute("tabindex","0"),0===e&&t.setAttribute("aria-current","true"),t.addEventListener("click",r),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),r())})}),i.addEventListener("ended",function(){var t=u+1;t<n.length&&x(t)}),i.addEventListener("timeupdate",function(){var e=t.querySelector(".podloom-playlist-chapters .podcast20-chapters-list");if(e){var r=e.querySelectorAll(".chapter-item"),a=i.currentTime,n=null;if(r.forEach(function(t){var e=parseFloat(t.getAttribute("data-start-time"));!isNaN(e)&&a>=e&&(n=t)}),r.forEach(function(t){t.classList.remove("active")}),n&&n.classList.add("active"),o){var s=null;if(n){var c=n.querySelector(".chapter-img");c&&(s=c.src)}if(s)o.src!==s&&(o.src=s);else{var l=o.getAttribute("data-original-src");l&&o.src!==l&&(o.src=l)}}}})}}}else console.warn("PodLoom: No playlist data found")}function f(t){if(!t||isNaN(t))return"";t=parseInt(t,10);var e=Math.floor(t/3600),r=Math.floor(t%3600/60),a=t%60;return e>0?e+":"+h(r)+":"+h(a):r+":"+h(a)}function h(t){return t<10?"0"+t:t}function m(t){var e;s&&t.title&&(s.textContent=t.title),c&&t.date&&(c.textContent=(e=t.date)?new Date(1e3*e).toLocaleDateString():""),l&&t.duration&&(l.textContent=f(t.duration)),o&&t.image&&(o.src=t.image,o.alt=t.title||"",o.setAttribute("data-original-src",t.image))}function v(t){if(!t||0===t.length)return'<p class="no-content">No chapters available for this episode.</p>';var e='<div class="podcast20-chapters-list">';return e+='<h4 class="chapters-heading">Chapters</h4>',t.forEach(function(t){var r=t.startTime||0,a=f(r),n=S(t.title||"");e+='<div class="chapter-item" data-start-time="'+r+'">',t.img?e+='<img src="'+S(t.img)+'" alt="'+n+'" class="chapter-img" loading="lazy" />':e+='<div class="chapter-img-placeholder"></div>',e+='<div class="chapter-info">',e+='<button class="chapter-timestamp" data-start-time="'+r+'">'+a+"</button>",e+='<span class="chapter-title">'+n,t.url&&(e+=' <a href="'+S(t.url)+'" target="_blank" rel="noopener noreferrer" class="chapter-external-link" title="Open chapter link">',e+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block; vertical-align: middle; margin-left: 4px;">',e+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',e+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',e+="</svg></a>"),e+="</span>",e+="</div>",e+="</div>"}),e+="</div>"}function y(t){if(!t||0===t.length)return'<p class="no-content">No credits available for this episode.</p>';var e='<div class="podcast20-people">';return e+='<h4 class="podcast20-heading">Credits</h4>',e+='<div class="podcast20-people-list">',t.forEach(function(t){if(t.name){var r=S(t.name),a=t.role?S(t.role):"";e+='<div class="podcast20-person">',t.img?e+='<img src="'+S(t.img)+'" alt="'+r+'" class="podcast20-person-img">':(e+='<div class="podcast20-person-avatar">',e+='<svg width="40" height="40" viewBox="0 0 16 16" fill="currentColor">',e+='<path d="M11 6a3 3 0 11-6 0 3 3 0 016 0z"/>',e+='<path d="M2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2zm12 1a1 1 0 011 1v12a1 1 0 01-1 1v-1c0-1-1-4-6-4s-6 3-6 4v1a1 1 0 01-1-1V2a1 1 0 011-1h12z"/>',e+="</svg></div>"),e+='<div class="podcast20-person-info">',a&&(e+='<span class="podcast20-person-role">'+a.charAt(0).toUpperCase()+a.slice(1)+"</span>"),t.href?e+='<a href="'+S(t.href)+'" target="_blank" rel="noopener noreferrer" class="podcast20-person-name">'+r+"</a>":e+='<span class="podcast20-person-name">'+r+"</span>",e+="</div>",e+="</div>"}}),e+="</div>",e+="</div>"}function b(t){if(!t||0===t.length)return'<p class="no-content">No transcript available for this episode.</p>';var e={"text/html":1,"application/x-subrip":2,"text/srt":2,"text/vtt":3,"application/json":4,"text/plain":5};t.sort(function(t,r){return(e[t.type]||999)-(e[r.type]||999)});var r=t[0],a=JSON.stringify(t),n='<div class="podcast20-transcripts">';return n+='<div class="transcript-formats">',n+='<button class="transcript-format-button" data-url="'+S(r.url)+'" data-type="'+S(r.type||"text/plain")+"\" data-transcripts='"+S(a).replace(/'/g,"&#39;")+"'>",n+='<svg class="podcast20-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">',n+='<path d="M14 4.5V14a2 2 0 01-2 2H4a2 2 0 01-2-2V2a2 2 0 012-2h5.5L14 4.5zm-3 0A1.5 1.5 0 019.5 3V1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4.5h-2z"/>',n+='<path d="M3 9.5h10v1H3v-1zm0 2h10v1H3v-1z"/>',n+="</svg>",n+="<span>Click for Transcript</span>",n+="</button>",n+=' <a href="'+S(r.url)+'" target="_blank" rel="noopener noreferrer" class="transcript-external-link" title="Open transcript in new tab">',n+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">',n+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',n+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',n+="</svg></a>",n+="</div>",n+='<div class="transcript-viewer" style="display: none;">',n+='<div class="transcript-content"></div>',n+='<button class="transcript-close">Close</button>',n+="</div>",n+="</div>"}function g(t,e){t.querySelectorAll(".chapter-item").forEach(function(t){t.style.cursor="pointer",t.addEventListener("click",function(r){if(!r.target.closest(".chapter-external-link")){r.preventDefault();var a=parseFloat(t.getAttribute("data-start-time"));isNaN(a)||(e.currentTime=a,e.paused&&e.play().catch(function(t){console.warn("PodLoom: Could not auto-play",t)}))}})})}function A(t){t.querySelectorAll(".transcript-format-button").forEach(function(t){t.addEventListener("click",function(){var e,r=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),n=r.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),r.style.display="none",void(n.innerHTML="");try{e=JSON.parse(t.getAttribute("data-transcripts"))}catch(t){e=[]}0!==e.length&&(t.classList.add("loading"),r.style.display="block",n.innerHTML='<div class="transcript-loading">Loading transcript...</div>',a(e,0,t,n))})}),t.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){var e=t.closest(".transcript-viewer"),r=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),a=e.querySelector(".transcript-content");r.classList.remove("active"),e.style.display="none",a.innerHTML=""})})}function L(t,e,r){if("undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl){var a=new XMLHttpRequest;a.open("POST",podloomPlaylist.ajaxUrl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)try{var t=JSON.parse(a.responseText);t.success&&t.data?r(t.data):r(null)}catch(t){r(null)}else r(null)},a.send("action=podloom_get_episode_p20&feed_id="+encodeURIComponent(t)+"&episode_id="+encodeURIComponent(e)+"&nonce="+encodeURIComponent(podloomPlaylist.nonce||""))}else r(null)}function x(r){if(!(r<0||r>=n.length)){var a=n[r];u=r;var o,s=i.querySelector("source");s?s.src=a.audio_url:i.src=a.audio_url,i.load(),i.play().catch(function(t){console.warn("PodLoom: Could not auto-play episode",t)}),m(a),o=r,d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){var r=t.querySelector(".podloom-episode-play-overlay");r&&(e===o?(t.classList.add("podloom-episode-current"),t.setAttribute("aria-current","true"),r.innerHTML='<span class="podloom-now-playing-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite"/></rect><rect x="10" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="8;16;8" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="8;4;8" dur="0.8s" repeatCount="indefinite"/></rect><rect x="16" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite" begin="0.2s"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite" begin="0.2s"/></rect></svg></span>'):(t.classList.remove("podloom-episode-current"),t.removeAttribute("aria-current"),r.innerHTML='<span class="podloom-play-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>'))}),function(e){var r=t.querySelector('[data-tab-id="description"]');if(r){var a=r.querySelector(".podloom-playlist-description");if(a){var n=e.content||e.description||"";a.innerHTML=n}}var o=e.podcast20,s=t.querySelector('[data-tab-id="chapters"]');if(s){var c=s.querySelector(".podloom-playlist-chapters");if(c){var l=o&&o.chapters&&o.chapters.chapters?o.chapters.chapters:null;l&&l.length>0?(c.innerHTML=v(l),g(c,i)):p&&e.id?L(p,e.id,function(t){var e=t&&t.chapters&&t.chapters.chapters?t.chapters.chapters:null;e&&e.length>0?(c.innerHTML=v(e),g(c,i)):c.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}):c.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}}var d=t.querySelector('[data-tab-id="credits"]');if(d){var u=d.querySelector(".podloom-playlist-credits");if(u)if(o&&(o.people_channel&&o.people_channel.length>0||o.people_episode&&o.people_episode.length>0)){var f=[];o.people_channel&&(f=f.concat(o.people_channel)),o.people_episode&&(f=f.concat(o.people_episode)),u.innerHTML=y(f)}else p&&e.id?L(p,e.id,function(t){if(t){var e=[];t.people_channel&&(e=e.concat(t.people_channel)),t.people_episode&&(e=e.concat(t.people_episode)),e.length>0?u.innerHTML=y(e):u.innerHTML='<p class="no-content">No credits available for this episode.</p>'}else u.innerHTML='<p class="no-content">No credits available for this episode.</p>'}):u.innerHTML='<p class="no-content">No credits available for this episode.</p>'}var h=t.querySelector('[data-tab-id="transcripts"]');if(h){var m=h.querySelector(".podloom-playlist-transcripts");m&&(o&&o.transcripts&&o.transcripts.length>0?(m.innerHTML=b(o.transcripts),A(m)):p&&e.id?L(p,e.id,function(t){t&&t.transcripts&&t.transcripts.length>0?(m.innerHTML=b(t.transcripts),A(m)):m.innerHTML='<p class="no-content">No transcript available for this episode.</p>'}):m.innerHTML='<p class="no-content">No transcript available for this episode.</p>')}}(a);var c=d.querySelector('[data-episode-index="'+r+'"]');c&&c.scrollIntoView({behavior:"smooth",block:"nearest"}),e("Now playing: "+(a.title||"Episode "+(r+1)))}}function S(t){if(!t)return"";var e=document.createElement("div");return e.textContent=t,e.innerHTML}})}function p(){"undefined"!=typeof podloomImageCache&&podloomImageCache.ajaxUrl&&fetch(podloomImageCache.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=podloom_process_image_cache"}).then(function(t){return t.json()}).then(function(t){t.success&&t.data.remaining>0&&setTimeout(p,1e3)}).catch(function(){})}function f(){!function(){function t(t,e,r,a){const n=t.getAttribute("data-tab");e.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1")}),r.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-hidden","true")}),t.classList.add("active"),t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0");const i=a.querySelector("#tab-panel-"+n);i&&(i.classList.add("active"),i.setAttribute("aria-hidden","false"))}document.querySelectorAll(".podcast20-tabs").forEach(function(e){const r=e.querySelectorAll(".podcast20-tab-button"),a=e.querySelectorAll(".podcast20-tab-panel");a.forEach(function(t){t.classList.contains("active")?t.setAttribute("aria-hidden","false"):t.setAttribute("aria-hidden","true")}),r.forEach(function(t,e){t.setAttribute("tabindex",t.classList.contains("active")?"0":"-1")}),r.forEach(function(n,i){n.addEventListener("click",function(){t(n,r,a,e)}),n.addEventListener("keydown",function(n){let o=-1;const s=i;"ArrowRight"===n.key||"ArrowDown"===n.key?(n.preventDefault(),o=(s+1)%r.length):"ArrowLeft"===n.key||"ArrowUp"===n.key?(n.preventDefault(),o=(s-1+r.length)%r.length):"Home"===n.key?(n.preventDefault(),o=0):"End"===n.key&&(n.preventDefault(),o=r.length-1),o>=0&&(r[o].focus(),t(r[o],r,a,e))})})})}(),document.querySelectorAll(".podcast20-chapters-list").forEach(function(t){const a=t.closest(".rss-episode-player");if(!a)return void console.warn("PodLoom: Chapter list found but no episode container");const n=a.querySelector("audio");if(!n)return void console.warn("PodLoom: Chapter list found but no audio player in episode container");const i=a.querySelector(".rss-episode-artwork img");i&&(i.hasAttribute("data-original-src")||i.setAttribute("data-original-src",i.src)),t.querySelectorAll(".chapter-item").forEach(function(a){function i(i){if("A"===i.target.tagName&&i.target.classList.contains("chapter-external-link"))return;if(i.target.closest(".chapter-external-link"))return;i.preventDefault();const o=parseFloat(a.getAttribute("data-start-time"));isNaN(o)||(n.currentTime=o,n.paused&&n.play().catch(function(t){console.warn("PodLoom: Could not auto-play audio:",t)}),r(t,o),e("Playing chapter: "+(a.querySelector(".chapter-title")?.textContent||"")))}a.style.cursor="pointer",a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.addEventListener("click",i),a.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i(t))})}),n.addEventListener("timeupdate",function(){const e=n.currentTime;r(t,e)})}),document.querySelectorAll(".transcript-format-button").forEach(function(t){t.setAttribute("aria-expanded","false"),t.addEventListener("click",function(){const e=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),r=e.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),t.setAttribute("aria-expanded","false"),e.style.display="none",void(r.innerHTML="");let n;try{const e=t.getAttribute("data-transcripts");n=JSON.parse(e)}catch(e){n=[{url:t.getAttribute("data-url"),type:t.getAttribute("data-type")||"text/plain"}]}t.classList.add("loading"),t.setAttribute("aria-busy","true"),e.style.display="block",e.setAttribute("aria-busy","true"),r.innerHTML='<div class="transcript-loading" role="status">Loading transcript...</div>',a(n,0,t,r)})}),document.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){const e=t.closest(".transcript-viewer"),r=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),a=e.querySelector(".transcript-content");r.classList.remove("active"),r.setAttribute("aria-expanded","false"),e.style.display="none",a.innerHTML="",r.focus()})}),document.querySelectorAll(".podloom-skip-btn").forEach(function(t){t.hasAttribute("data-initialized")||(t.setAttribute("data-initialized","true"),t.addEventListener("click",function(){var e=parseInt(t.getAttribute("data-skip"),10),r=t.closest(".rss-episode-player");if(r){var a=r.querySelector("audio");if(a){var n=a.currentTime+e;n=Math.max(0,Math.min(n,a.duration||1/0)),a.currentTime=n}}}))}),u(),document.querySelectorAll(".podloom-player-container").forEach(function(t){if(!t.hasAttribute("data-player-initialized")){t.setAttribute("data-player-initialized","true");var e=t.querySelector(".podloom-audio-element");if(e){var r=t.querySelector(".podloom-play-toggle"),a=t.querySelector(".podloom-timeline-container"),n=t.querySelector(".podloom-timeline-progress"),i=t.querySelector(".podloom-timeline-slider"),o=t.querySelector(".podloom-current-time"),s=t.querySelector(".podloom-duration"),l=t.querySelector(".podloom-speed-btn"),d=[1,1.25,1.5,2],u=0;r&&r.addEventListener("click",function(){e.paused?e.play().catch(function(t){console.warn("PodLoom: Could not play audio",t)}):e.pause()}),e.addEventListener("play",function(){t.classList.add("is-playing"),r&&r.setAttribute("aria-label",r.getAttribute("data-pause-label")||"Pause")}),e.addEventListener("pause",function(){t.classList.remove("is-playing"),r&&r.setAttribute("aria-label",r.getAttribute("data-play-label")||"Play")}),e.addEventListener("ended",function(){t.classList.remove("is-playing"),r&&r.setAttribute("aria-label",r.getAttribute("data-play-label")||"Play")}),e.addEventListener("timeupdate",function(){var t=e.currentTime,r=e.duration||0;if(o&&(o.textContent=c(t)),r>0&&n){var a=t/r*100;n.style.width=a+"%"}r>0&&i&&(i.value=t)}),e.addEventListener("loadedmetadata",function(){s&&(s.textContent=c(e.duration)),i&&(i.max=e.duration)}),e.addEventListener("durationchange",function(){s&&e.duration&&isFinite(e.duration)&&(s.textContent=c(e.duration)),i&&e.duration&&isFinite(e.duration)&&(i.max=e.duration)}),i&&i.addEventListener("input",function(){var t=parseFloat(i.value);isNaN(t)||(e.currentTime=t)}),a&&a.addEventListener("click",function(t){var r=a.getBoundingClientRect(),n=(t.clientX-r.left)/r.width*(e.duration||0);!isNaN(n)&&isFinite(n)&&(e.currentTime=n)}),l&&l.addEventListener("click",function(){var t=d[u=(u+1)%d.length];e.playbackRate=t,l.textContent=t+"x"})}}}),setTimeout(p,500)}if("loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f(),void 0!==window.MutationObserver){new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&t.addedNodes.forEach(function(t){1===t.nodeType&&(t.classList&&(t.classList.contains("podcast20-tabs")||t.classList.contains("podcast20-chapters-list")||t.classList.contains("rss-playlist-player")||t.classList.contains("podloom-player-container"))||t.querySelector&&(t.querySelector(".podcast20-tabs")||t.querySelector(".podcast20-chapters-list")||t.querySelector(".rss-playlist-player")||t.querySelector(".podloom-player-container")))&&f()})})}).observe(document.body,{childList:!0,subtree:!0})}}();