!function(){"use strict";var t=null;function e(e){var a=(t||((t=document.createElement("div")).setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="podloom-sr-announcer",t.style.cssText="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;",document.body.appendChild(t)),t);a.textContent="",setTimeout(function(){a.textContent=e},50)}function a(t,e){const a=t.querySelectorAll(".chapter-item");let o=null;a.forEach(function(t){const a=parseFloat(t.getAttribute("data-start-time"));!isNaN(a)&&e>=a&&(o=t)}),a.forEach(function(t){t.classList.remove("active"),t.removeAttribute("aria-current")}),o&&(o.classList.add("active"),o.setAttribute("aria-current","true"));const r=t.closest(".rss-episode-player");if(r){const t=r.querySelector(".rss-episode-artwork img");if(t){let e=null;if(o){const t=o.querySelector(".chapter-img");t&&(e=t.src)}if(e)t.src!==e&&(t.src=e);else{const e=t.getAttribute("data-original-src");e&&t.src!==e&&(t.src=e)}}}}function o(t,a,s,c){var p=c.closest(".transcript-viewer");if(a>=t.length){s.classList.remove("loading"),s.removeAttribute("aria-busy"),p&&p.removeAttribute("aria-busy");const e=(t[0].url||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return void(c.innerHTML='<div class="transcript-error" role="alert">Could not load transcript. <a href="'+e+'" target="_blank" rel="noopener noreferrer">Open in new tab</a></div>')}const u=t[a],m=u.url,f=u.type||"text/plain",h="undefined"!=typeof podloomTranscript&&podloomTranscript.ajaxUrl?podloomTranscript.ajaxUrl+"?action=podloom_fetch_transcript&url="+encodeURIComponent(m):m;fetch(h).then(function(t){return t.json().then(function(e){if(!t.ok){const a=e.data&&e.data.message?e.data.message:"HTTP "+t.status;throw console.error("Transcript proxy error ("+t.status+"):",a,"URL:",m),new Error(a)}return e})}).then(function(t){if(!(t.success&&t.data&&t.data.content))throw new Error(t.data?t.data.message:"Failed to load transcript");{const a=function(t,e){var a=t.trim();if(a.startsWith("<!DOCTYPE")||a.startsWith("<html")||a.includes("<body")&&a.includes("</body>"))return n(t);if(e.includes("html"))return n(t);if(e.includes("srt"))return i(t);if(e.includes("vtt"))return function(t){return t=t.replace(/^WEBVTT\s*\n/,""),i(t)}(t);if(e.includes("json"))return function(t){try{var e=JSON.parse(t),a="";return e.segments&&Array.isArray(e.segments)&&e.segments.forEach(function(t){void 0!==t.startTime&&t.body&&(a+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+l(t.startTime)+"</span>"+d(t.body)+"</p>")}),a||"<p>No transcript content found.</p>"}catch(t){return'<p class="transcript-error">Invalid JSON format.</p>'}}(t);if(e.includes("text/plain")||e.includes("text/txt")||e.includes(".txt"))return r(t);return r(t)}(t.data.content,f);c.innerHTML=a,s.classList.remove("loading"),s.classList.add("active"),s.removeAttribute("aria-busy"),s.setAttribute("aria-expanded","true"),p&&p.removeAttribute("aria-busy"),function(t){var a=t.querySelectorAll(".transcript-timestamp"),o=t.closest(".podcast20-transcripts"),r=o?o.closest(".rss-episode-player"):null;if(!r)return;var n=r.querySelector("audio");if(!n)return;a.forEach(function(t){function a(){var a=parseFloat(t.getAttribute("data-time"));isNaN(a)||(n.currentTime=a,n.paused&&n.play().catch(function(t){console.warn("Could not auto-play audio:",t)}),e("Seeking to "+t.textContent))}t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.addEventListener("click",a),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a())})})}(c),e("Transcript loaded")}}).catch(function(e){console.warn("Transcript load failed for "+m+", trying next format...",e),o(t,a+1,s,c)})}function r(t){var e=t.trim().split(/\n\s*\n/),a="";return e.forEach(function(t){t.trim()&&(a+="<p>"+d(t.trim().replace(/\n/g,"<br>"))+"</p>")}),a||"<p>"+d(t)+"</p>"}function n(t){for(var e=(new DOMParser).parseFromString(t,"text/html"),a=document.createElement("div"),o=[".transcript",".transcript-content",".episode-transcript","[data-transcript]","article","main",".content",".episode-content"],r=null,n=0;n<o.length&&!(r=e.querySelector(o[n]));n++);if(r)a.appendChild(r.cloneNode(!0));else{e.body&&Array.from(e.body.childNodes).forEach(function(t){a.appendChild(t.cloneNode(!0))});["header","nav","footer",".header",".navigation",".nav",".footer",".sidebar",".menu",".social",'[role="navigation"]','[role="banner"]','[role="complementary"]'].forEach(function(t){a.querySelectorAll(t).forEach(function(t){t.remove()})})}return["script","iframe","object","embed","link","style","form"].forEach(function(t){a.querySelectorAll(t).forEach(function(t){t.remove()})}),a.querySelectorAll("*").forEach(function(t){if(Array.from(t.attributes).forEach(function(e){(e.name.startsWith("on")||"style"===e.name)&&t.removeAttribute(e.name)}),t.hasAttribute("href")){var e=t.getAttribute("href");e&&(e.toLowerCase().startsWith("javascript:")||e.toLowerCase().startsWith("data:"))&&t.removeAttribute("href")}}),a.querySelectorAll("[data-time], [data-timestamp]").forEach(function(t){t.classList.contains("transcript-timestamp")||t.classList.add("transcript-timestamp"),t.hasAttribute("data-timestamp")&&!t.hasAttribute("data-time")&&t.setAttribute("data-time",t.getAttribute("data-timestamp"))}),function(t){var e,a=[],o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;e=o.nextNode();)e.textContent.trim()&&a.push(e);return a}(a).forEach(function(t){for(var e,a=t.textContent,o=/[\[\(]?(\d{1,2}):(\d{2})(?::(\d{2}))?[\]\)]?/g,r=[];null!==(e=o.exec(a));){var n;if(e[3])n=3600*parseInt(e[1],10)+60*parseInt(e[2],10)+parseInt(e[3],10);else n=60*parseInt(e[1],10)+parseInt(e[2],10);n<86400&&r.push({match:e[0],index:e.index,time:n})}if(r.length>0){var i=document.createDocumentFragment(),s=0;r.forEach(function(t){t.index>s&&i.appendChild(document.createTextNode(a.substring(s,t.index)));var e=document.createElement("span");e.className="transcript-timestamp",e.setAttribute("data-time",t.time),e.textContent=t.match,i.appendChild(e),s=t.index+t.match.length}),s<a.length&&i.appendChild(document.createTextNode(a.substring(s))),t.parentNode&&t.parentNode.replaceChild(i,t)}}),a.innerHTML}function i(t){var e=t.trim().split(/\n\s*\n/),a=[];if(e.forEach(function(t){var e=t.split("\n");if(!(e.length<3)){var o=e[1].split(" --\x3e ");if(!(o.length<2)){var r=s(o[0]),n=s(o[1]),i=e.slice(2).join(" ").trim();!isNaN(r)&&i&&a.push({startTime:r,endTime:n,text:i})}}}),0===a.length)return"<p>No transcript content found.</p>";var o=[],r=null;a.forEach(function(t,e){var n=e>0?a[e-1]:null,i=n?t.startTime-n.endTime:0;!r||i>=3?(r&&o.push(r),r={startTime:t.startTime,texts:[t.text]}):r.texts.push(t.text)}),r&&o.push(r);var n="";return o.forEach(function(t){var e=t.texts.join(" ");n+='<p><span class="transcript-timestamp" data-time="'+t.startTime+'">'+l(t.startTime)+"</span> "+d(e)+"</p>"}),n}function s(t){var e=t.split(":");return 3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseFloat(e[2].replace(",","."))}function l(t){var e=Math.floor(t/3600),a=Math.floor(t%3600/60),o=Math.floor(t%60);return e>0?e+":"+c(a)+":"+c(o):a+":"+c(o)}function c(t){return t<10?"0"+t:t}function d(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}function p(){document.querySelectorAll(".rss-playlist-player").forEach(function(t){if(!t.hasAttribute("data-playlist-initialized")){t.setAttribute("data-playlist-initialized","true");var a=t.querySelector(".podloom-playlist-data");if(a){var r;try{r=JSON.parse(a.textContent)}catch(t){return void console.error("PodLoom: Failed to parse playlist data",t)}if(r&&0!==r.length){var n=t.querySelector(".podloom-playlist-audio"),i=t.querySelector(".podloom-playlist-artwork"),s=t.querySelector(".podloom-playlist-title"),l=t.querySelector(".podloom-playlist-date"),c=t.querySelector(".podloom-playlist-duration"),d=t.querySelector(".podloom-episodes-list");if(n&&d){var p=0,u=t.getAttribute("data-feed-id")||"",m=parseInt(t.getAttribute("data-total-episodes")||r.length,10),f=function(t,e,a){var o=[],r=e.slice(),n=!1,i=r.length<a,s=r.length;function l(){if(n||!i)return Promise.resolve([]);if(o.length>=10)return Promise.resolve([]);n=!0;var e="undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl?podloomPlaylist.ajaxUrl:"undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",a="undefined"!=typeof podloomPlaylist&&podloomPlaylist.nonce?podloomPlaylist.nonce:"";return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=podloom_get_rss_episodes_public&feed_id="+encodeURIComponent(t)+"&offset="+s+"&limit=20&nonce="+encodeURIComponent(a)}).then(function(t){return t.json()}).then(function(t){if(n=!1,t.success&&t.data&&t.data.episodes){var e=t.data.episodes;return o=o.concat(e),s+=e.length,i=t.data.has_more,e}return[]}).catch(function(){return n=!1,[]})}return i&&setTimeout(l,1e3),{getMore:function(t){if(t=t||10,o.length>=t){var e=o.splice(0,t);return r=r.concat(e),o.length<10&&i&&l(),Promise.resolve(e)}return l().then(function(){if(o.length>0){var e=o.splice(0,Math.min(t,o.length));return r=r.concat(e),e}return[]})},hasMore:function(){return i||o.length>0},getDisplayed:function(){return r},isLoading:function(){return n}}}(u,r,m);d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){function a(){var e=parseInt(t.getAttribute("data-episode-index"),10);isNaN(e)||e===p?e===p&&n.paused&&n.play().catch(function(t){console.warn("PodLoom: Could not play",t)}):w(e)}t.style.cursor="pointer",t.setAttribute("role","button"),t.setAttribute("tabindex","0"),0===e&&t.setAttribute("aria-current","true"),t.addEventListener("click",a),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a())})}),n.addEventListener("ended",function(){var t=p+1;t<r.length&&w(t)}),n.addEventListener("timeupdate",function(){var e=t.querySelector(".podloom-playlist-chapters .podcast20-chapters-list");if(e){var a=e.querySelectorAll(".chapter-item"),o=n.currentTime,r=null;if(a.forEach(function(t){var e=parseFloat(t.getAttribute("data-start-time"));!isNaN(e)&&o>=e&&(r=t)}),a.forEach(function(t){t.classList.remove("active")}),r&&r.classList.add("active"),i){var s=null;if(r){var l=r.querySelector(".chapter-img");l&&(s=l.src)}if(s)i.src!==s&&(i.src=s);else{var c=i.getAttribute("data-original-src");c&&i.src!==c&&(i.src=c)}}}});var h=!1;d.addEventListener("scroll",function(){!h&&f.hasMore()&&(d.scrollHeight-d.scrollTop-d.clientHeight<200&&(h=!0,f.getMore(10).then(function(t){t.length>0&&function(t){t.forEach(function(t,e){var a=r.length;r.push(t);var o=document.createElement("div");o.className="podloom-episode-item",o.setAttribute("data-episode-index",a),o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.style.cursor="pointer";var i=document.createElement("div");i.className="podloom-episode-thumb",t.image?i.innerHTML='<img src="'+C(t.image)+'" alt="'+C(t.title||"")+'" loading="lazy">':i.classList.add("podloom-episode-thumb-placeholder");var s=document.createElement("div");s.className="podloom-episode-play-overlay",s.innerHTML='<span class="podloom-play-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>',i.appendChild(s);var l=document.createElement("div");l.className="podloom-episode-info";var c=document.createElement("div");c.className="podloom-episode-title-row",c.innerHTML='<div class="podloom-episode-item-title">'+C(t.title||"")+"</div>",l.appendChild(c);var u=document.createElement("div");u.className="podloom-episode-meta-row",t.date&&(u.innerHTML+='<span class="podloom-episode-item-date">'+g(t.date)+"</span>"),t.duration&&(u.innerHTML+='<span class="podloom-episode-item-duration">'+v(t.duration)+"</span>"),l.appendChild(u),o.appendChild(i),o.appendChild(l),d.appendChild(o),o.addEventListener("click",function(){a!==p?w(a):n.paused&&n.play().catch(function(){})}),o.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),o.click())})})}(t),h=!1})))})}}}else console.warn("PodLoom: No playlist data found")}function v(t){if(!t||isNaN(t))return"";t=parseInt(t,10);var e=Math.floor(t/3600),a=Math.floor(t%3600/60),o=t%60;return e>0?e+":"+y(a)+":"+y(o):a+":"+y(o)}function y(t){return t<10?"0"+t:t}function g(t){return t?new Date(1e3*t).toLocaleDateString():""}function b(t){if(!t||0===t.length)return'<p class="no-content">No chapters available for this episode.</p>';var e='<div class="podcast20-chapters-list">';return e+='<h4 class="chapters-heading">Chapters</h4>',t.forEach(function(t){var a=t.startTime||0,o=v(a),r=C(t.title||"");e+='<div class="chapter-item" data-start-time="'+a+'">',t.img?e+='<img src="'+C(t.img)+'" alt="'+r+'" class="chapter-img" loading="lazy" />':e+='<div class="chapter-img-placeholder"></div>',e+='<div class="chapter-info">',e+='<button class="chapter-timestamp" data-start-time="'+a+'">'+o+"</button>",e+='<span class="chapter-title">'+r,t.url&&(e+=' <a href="'+C(t.url)+'" target="_blank" rel="noopener noreferrer" class="chapter-external-link" title="Open chapter link">',e+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block; vertical-align: middle; margin-left: 4px;">',e+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',e+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',e+="</svg></a>"),e+="</span>",e+="</div>",e+="</div>"}),e+="</div>"}function L(t){if(!t||0===t.length)return'<p class="no-content">No credits available for this episode.</p>';var e='<div class="podcast20-people">';return e+='<h4 class="podcast20-heading">Credits</h4>',e+='<div class="podcast20-people-list">',t.forEach(function(t){if(t.name){var a=C(t.name),o=t.role?C(t.role):"";e+='<div class="podcast20-person">',t.img?e+='<img src="'+C(t.img)+'" alt="'+a+'" class="podcast20-person-img">':(e+='<div class="podcast20-person-avatar">',e+='<svg width="40" height="40" viewBox="0 0 16 16" fill="currentColor">',e+='<path d="M11 6a3 3 0 11-6 0 3 3 0 016 0z"/>',e+='<path d="M2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2zm12 1a1 1 0 011 1v12a1 1 0 01-1 1v-1c0-1-1-4-6-4s-6 3-6 4v1a1 1 0 01-1-1V2a1 1 0 011-1h12z"/>',e+="</svg></div>"),e+='<div class="podcast20-person-info">',o&&(e+='<span class="podcast20-person-role">'+o.charAt(0).toUpperCase()+o.slice(1)+"</span>"),t.href?e+='<a href="'+C(t.href)+'" target="_blank" rel="noopener noreferrer" class="podcast20-person-name">'+a+"</a>":e+='<span class="podcast20-person-name">'+a+"</span>",e+="</div>",e+="</div>"}}),e+="</div>",e+="</div>"}function A(t){if(!t||0===t.length)return'<p class="no-content">No transcript available for this episode.</p>';var e={"text/html":1,"application/x-subrip":2,"text/srt":2,"text/vtt":3,"application/json":4,"text/plain":5};t.sort(function(t,a){return(e[t.type]||999)-(e[a.type]||999)});var a=t[0],o=JSON.stringify(t),r='<div class="podcast20-transcripts">';return r+='<div class="transcript-formats">',r+='<button class="transcript-format-button" data-url="'+C(a.url)+'" data-type="'+C(a.type||"text/plain")+"\" data-transcripts='"+C(o).replace(/'/g,"&#39;")+"'>",r+='<svg class="podcast20-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">',r+='<path d="M14 4.5V14a2 2 0 01-2 2H4a2 2 0 01-2-2V2a2 2 0 012-2h5.5L14 4.5zm-3 0A1.5 1.5 0 019.5 3V1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4.5h-2z"/>',r+='<path d="M3 9.5h10v1H3v-1zm0 2h10v1H3v-1z"/>',r+="</svg>",r+="<span>Click for Transcript</span>",r+="</button>",r+=' <a href="'+C(a.url)+'" target="_blank" rel="noopener noreferrer" class="transcript-external-link" title="Open transcript in new tab">',r+='<svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">',r+='<path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086 0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/>',r+='<path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02 0 01-.82 1H12a3 3 0 100-6H9z"/>',r+="</svg></a>",r+="</div>",r+='<div class="transcript-viewer" style="display: none;">',r+='<div class="transcript-content"></div>',r+='<button class="transcript-close">Close</button>',r+="</div>",r+="</div>"}function x(t,e){t.querySelectorAll(".chapter-item").forEach(function(t){t.style.cursor="pointer",t.addEventListener("click",function(a){if(!a.target.closest(".chapter-external-link")){a.preventDefault();var o=parseFloat(t.getAttribute("data-start-time"));isNaN(o)||(e.currentTime=o,e.paused&&e.play().catch(function(t){console.warn("PodLoom: Could not auto-play",t)}))}})})}function E(t){t.querySelectorAll(".transcript-format-button").forEach(function(t){t.addEventListener("click",function(){var e,a=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),r=a.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),a.style.display="none",void(r.innerHTML="");try{e=JSON.parse(t.getAttribute("data-transcripts"))}catch(t){e=[]}0!==e.length&&(t.classList.add("loading"),a.style.display="block",r.innerHTML='<div class="transcript-loading">Loading transcript...</div>',o(e,0,t,r))})}),t.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){var e=t.closest(".transcript-viewer"),a=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),o=e.querySelector(".transcript-content");a.classList.remove("active"),e.style.display="none",o.innerHTML=""})})}function S(t,e,a){if("undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl){var o=new XMLHttpRequest;o.open("POST",podloomPlaylist.ajaxUrl,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var t=JSON.parse(o.responseText);t.success&&t.data?a(t.data):a(null)}catch(t){a(null)}else a(null)},o.send("action=podloom_get_episode_p20&feed_id="+encodeURIComponent(t)+"&episode_id="+encodeURIComponent(e)+"&nonce="+encodeURIComponent(podloomPlaylist.nonce||""))}else a(null)}function w(a){if(!(a<0||a>=r.length)){var o=r[a];p=a;var m,f=n.querySelector("source");f?f.src=o.audio_url:n.src=o.audio_url,n.load(),n.play().catch(function(t){console.warn("PodLoom: Could not auto-play episode",t)}),function(t){s&&t.title&&(s.textContent=t.title),l&&t.date&&(l.textContent=g(t.date)),c&&t.duration&&(c.textContent=v(t.duration)),i&&t.image&&(i.src=t.image,i.alt=t.title||"",i.setAttribute("data-original-src",t.image))}(o),m=a,d.querySelectorAll(".podloom-episode-item").forEach(function(t,e){var a=t.querySelector(".podloom-episode-play-overlay");a&&(e===m?(t.classList.add("podloom-episode-current"),t.setAttribute("aria-current","true"),a.innerHTML='<span class="podloom-now-playing-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite"/></rect><rect x="10" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="8;16;8" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="8;4;8" dur="0.8s" repeatCount="indefinite"/></rect><rect x="16" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite" begin="0.2s"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite" begin="0.2s"/></rect></svg></span>'):(t.classList.remove("podloom-episode-current"),t.removeAttribute("aria-current"),a.innerHTML='<span class="podloom-play-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>'))}),function(e){var a=t.querySelector('[data-tab-id="description"]');if(a){var o=a.querySelector(".podloom-playlist-description");if(o){var r=e.content||e.description||"";o.innerHTML=r}}var i=e.podcast20,s=t.querySelector('[data-tab-id="chapters"]');if(s){var l=s.querySelector(".podloom-playlist-chapters");if(l){var c=i&&i.chapters&&i.chapters.chapters?i.chapters.chapters:null;c&&c.length>0?(l.innerHTML=b(c),x(l,n)):u&&e.id?S(u,e.id,function(t){var e=t&&t.chapters&&t.chapters.chapters?t.chapters.chapters:null;e&&e.length>0?(l.innerHTML=b(e),x(l,n)):l.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}):l.innerHTML='<p class="no-content">No chapters available for this episode.</p>'}}var d=t.querySelector('[data-tab-id="credits"]');if(d){var p=d.querySelector(".podloom-playlist-credits");if(p)if(i&&(i.people_channel&&i.people_channel.length>0||i.people_episode&&i.people_episode.length>0)){var m=[];i.people_channel&&(m=m.concat(i.people_channel)),i.people_episode&&(m=m.concat(i.people_episode)),p.innerHTML=L(m)}else u&&e.id?S(u,e.id,function(t){if(t){var e=[];t.people_channel&&(e=e.concat(t.people_channel)),t.people_episode&&(e=e.concat(t.people_episode)),e.length>0?p.innerHTML=L(e):p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}else p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}):p.innerHTML='<p class="no-content">No credits available for this episode.</p>'}var f=t.querySelector('[data-tab-id="transcripts"]');if(f){var h=f.querySelector(".podloom-playlist-transcripts");h&&(i&&i.transcripts&&i.transcripts.length>0?(h.innerHTML=A(i.transcripts),E(h)):u&&e.id?S(u,e.id,function(t){t&&t.transcripts&&t.transcripts.length>0?(h.innerHTML=A(t.transcripts),E(h)):h.innerHTML='<p class="no-content">No transcript available for this episode.</p>'}):h.innerHTML='<p class="no-content">No transcript available for this episode.</p>')}}(o);var h=d.querySelector('[data-episode-index="'+a+'"]');h&&h.scrollIntoView({behavior:"smooth",block:"nearest"}),e("Now playing: "+(o.title||"Episode "+(a+1)))}}function C(t){if(!t)return"";var e=document.createElement("div");return e.textContent=t,e.innerHTML}})}function u(){document.querySelectorAll(".rss-playlist-player").forEach(function(t){if(!t.hasAttribute("data-search-pagination-initialized")){t.setAttribute("data-search-pagination-initialized","true");var a=t.getAttribute("data-feed-id"),o=parseInt(t.getAttribute("data-total"),10)||0,r=parseInt(t.getAttribute("data-loaded"),10)||0,n=parseInt(t.getAttribute("data-step"),10)||20,i=t.getAttribute("data-order")||"episodic",s=t.querySelector(".podloom-episodes-search-input"),l=t.querySelector(".podloom-episodes-search-clear"),c=t.querySelector(".podloom-search-status"),d=t.querySelector(".podloom-episodes-list"),p=t.querySelector(".podloom-episodes-load-more"),u=t.querySelector(".podloom-episodes-no-results"),m=null,f=null,h="",v=!1,y=t.querySelector(".podloom-playlist-data"),g=[];if(y)try{g=JSON.parse(y.textContent)}catch(t){console.error("PodLoom: Failed to parse playlist data")}s&&(s.addEventListener("input",function(){var t=s.value.trim();h=t,l&&(l.style.display=t?"":"none"),clearTimeout(m),clearTimeout(f),t?m=setTimeout(function(){var e=function(t){t=t.toLowerCase().trim();var e=d.querySelectorAll(".podloom-episode-item"),a=0;return e.forEach(function(e){var o=(e.getAttribute("data-search-term")||"").toLowerCase();t&&-1===o.indexOf(t)?e.classList.add("podloom-search-hidden"):(e.classList.remove("podloom-search-hidden"),a++)}),p&&(p.closest(".podloom-episodes-load-more-wrapper").style.display=t?"none":""),a}(t);c&&(o>r&&t.length>=2?c.textContent=e+" found (searching...)":c.textContent=e+" episode"+(1!==e?"s":"")+" found"),o>r&&t.length>=2?f=setTimeout(function(){h===t&&b(t)},400):u&&(u.style.display=0===e?"":"none",0===e&&(u.textContent='No episodes found for "'+t+'"'))},100):E()}),s.addEventListener("keydown",function(t){"Escape"===t.key&&(E(),s.blur())})),l&&l.addEventListener("click",function(){E(),s&&s.focus()}),p&&p.addEventListener("click",function(){if(p&&!p.hasAttribute("disabled")){p.setAttribute("disabled","true");var e=p.querySelector(".podloom-load-more-text"),s=p.querySelector(".podloom-load-more-loading");e&&(e.style.display="none"),s&&(s.style.display="");var l="undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl?podloomPlaylist.ajaxUrl:"/wp-admin/admin-ajax.php",c=new FormData;c.append("action","podloom_playlist_episodes"),c.append("feed_id",a),c.append("offset",r),c.append("limit",n),c.append("order",i),fetch(l,{method:"POST",body:c}).then(function(t){return t.json()}).then(function(a){if(p.removeAttribute("disabled"),e&&(e.style.display=""),s&&(s.style.display="none"),a.success&&a.data.episodes){var n=a.data.episodes;n.forEach(function(e,a){var o=L(e,r+a);d.appendChild(o),S(o,t,e),g.push(e)}),r+=n.length,t.setAttribute("data-loaded",r);var i=o-r;if(i<=0||!a.data.has_more){var l=p.closest(".podloom-episodes-load-more-wrapper");l&&(l.style.display="none")}else e&&(e.textContent="Load More ("+i+" remaining)")}}).catch(function(t){p.removeAttribute("disabled"),e&&(e.style.display=""),s&&(s.style.display="none"),console.error("PodLoom: Load more failed",t)})}})}function b(o){if(!(!o||o.length<2||v)){v=!0,c&&(c.textContent="Searching...");var r="undefined"!=typeof podloomPlaylist&&podloomPlaylist.ajaxUrl?podloomPlaylist.ajaxUrl:"/wp-admin/admin-ajax.php",n=new FormData;n.append("action","podloom_search_episodes"),n.append("feed_id",a),n.append("search",o),n.append("order",i),n.append("limit","50"),fetch(r,{method:"POST",body:n}).then(function(t){return t.json()}).then(function(a){v=!1,a.success&&a.data.episodes?function(a,o){var r=d.querySelectorAll(".podloom-episode-item");r.forEach(function(t){t.classList.add("podloom-search-hidden")});var n=0;a.forEach(function(e,a){var o=null;if(r.forEach(function(t){var a=t.querySelector(".podloom-episode-item-title");a&&a.textContent===e.title&&(o=t)}),o)o.classList.remove("podloom-search-hidden"),n++;else{var i=L(e,"search-"+a);i.classList.add("podloom-search-result"),d.appendChild(i),S(i,t,e),n++}}),c&&(c.textContent=n+" episode"+(1!==n?"s":"")+" found");u&&(u.style.display=0===n?"":"none",0===n&&(u.textContent='No episodes found for "'+o+'"'));e(n+" episode"+(1!==n?"s":"")+" found")}(a.data.episodes,o):c&&(c.textContent="")}).catch(function(t){v=!1,console.error("PodLoom: Search failed",t),c&&(c.textContent="")})}}function L(t,e){var a=document.createElement("div");a.className="podloom-episode-item",a.setAttribute("data-episode-index",e),a.setAttribute("data-search-term",(t.title||"").toLowerCase()),a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.style.cursor="pointer";var o=t.date?new Date(1e3*t.date).toLocaleDateString():"",r=t.duration?A(t.duration):"",n='<div class="podloom-episode-thumb'+(t.image?"":" podloom-episode-thumb-placeholder")+'">';t.image&&(n+='<img src="'+x(t.image)+'" alt="'+x(t.title)+'" loading="lazy" />'),n+='<div class="podloom-episode-play-overlay"><span class="podloom-play-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span></div></div>';var i='<div class="podloom-episode-info"><div class="podloom-episode-title-row"><span class="podloom-episode-item-title">'+x(t.title)+'</span></div><div class="podloom-episode-meta-row">'+(o?'<span class="podloom-episode-item-date">'+o+"</span>":"")+(r?'<span class="podloom-episode-item-duration">'+r+"</span>":"")+"</div></div>";return a.innerHTML=n+i,a.podloomEpisodeData=t,a}function A(t){if(!t||isNaN(t))return"";t=parseInt(t,10);var e=Math.floor(t/3600),a=Math.floor(t%3600/60),o=t%60;return e>0?e+":"+(a<10?"0":"")+a+":"+(o<10?"0":"")+o:a+":"+(o<10?"0":"")+o}function x(t){if(!t)return"";var e=document.createElement("div");return e.textContent=t,e.innerHTML}function E(){if(h="",s&&(s.value=""),l&&(l.style.display="none"),c&&(c.textContent=""),d.querySelectorAll(".podloom-search-result").forEach(function(t){t.remove()}),d.querySelectorAll(".podloom-episode-item").forEach(function(t){t.classList.remove("podloom-search-hidden")}),p){var t=p.closest(".podloom-episodes-load-more-wrapper");t&&(t.style.display="")}u&&(u.style.display="none")}function S(t,a,o){function r(){var r=o||t.podloomEpisodeData;if(r&&r.audio_url){var n=a.querySelector(".podloom-playlist-audio");if(n){var i=n.querySelector("source");i?i.src=r.audio_url:n.src=r.audio_url,n.load(),n.play().catch(function(t){console.warn("PodLoom: Could not play",t)}),function(t,e){var a=t.querySelector(".podloom-playlist-title"),o=t.querySelector(".podloom-playlist-date"),r=t.querySelector(".podloom-playlist-duration"),n=t.querySelector(".podloom-playlist-artwork");a&&e.title&&(a.textContent=e.title);o&&e.date&&(o.textContent=new Date(1e3*e.date).toLocaleDateString());r&&e.duration&&(r.textContent=A(e.duration));n&&e.image&&(n.src=e.image,n.alt=e.title||"",n.setAttribute("data-original-src",e.image))}(a,r),a.querySelectorAll(".podloom-episode-item").forEach(function(t){t.classList.remove("podloom-episode-current"),t.removeAttribute("aria-current");var e=t.querySelector(".podloom-episode-play-overlay");e&&(e.innerHTML='<span class="podloom-play-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg></span>')}),t.classList.add("podloom-episode-current"),t.setAttribute("aria-current","true");var s=t.querySelector(".podloom-episode-play-overlay");s&&(s.innerHTML='<span class="podloom-now-playing-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite"/></rect><rect x="10" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="8;16;8" dur="0.8s" repeatCount="indefinite"/><animate attributeName="y" values="8;4;8" dur="0.8s" repeatCount="indefinite"/></rect><rect x="16" y="4" width="4" height="16" rx="1"><animate attributeName="height" values="16;8;16" dur="0.8s" repeatCount="indefinite" begin="0.2s"/><animate attributeName="y" values="4;8;4" dur="0.8s" repeatCount="indefinite" begin="0.2s"/></rect></svg></span>'),e("Now playing: "+(r.title||"Episode"))}}}t.addEventListener("click",r),t.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),r())})}})}function m(){"undefined"!=typeof podloomImageCache&&podloomImageCache.ajaxUrl&&fetch(podloomImageCache.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=podloom_process_image_cache"}).then(function(t){return t.json()}).then(function(t){t.success&&t.data.remaining>0&&setTimeout(m,1e3)}).catch(function(){})}function f(){!function(){function t(t,e,a,o){const r=t.getAttribute("data-tab");e.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1")}),a.forEach(function(t){t.classList.remove("active"),t.setAttribute("aria-hidden","true")}),t.classList.add("active"),t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0");const n=o.querySelector("#tab-panel-"+r);n&&(n.classList.add("active"),n.setAttribute("aria-hidden","false"))}document.querySelectorAll(".podcast20-tabs").forEach(function(e){const a=e.querySelectorAll(".podcast20-tab-button"),o=e.querySelectorAll(".podcast20-tab-panel");o.forEach(function(t){t.classList.contains("active")?t.setAttribute("aria-hidden","false"):t.setAttribute("aria-hidden","true")}),a.forEach(function(t,e){t.setAttribute("tabindex",t.classList.contains("active")?"0":"-1")}),a.forEach(function(r,n){r.addEventListener("click",function(){t(r,a,o,e)}),r.addEventListener("keydown",function(r){let i=-1;const s=n;"ArrowRight"===r.key||"ArrowDown"===r.key?(r.preventDefault(),i=(s+1)%a.length):"ArrowLeft"===r.key||"ArrowUp"===r.key?(r.preventDefault(),i=(s-1+a.length)%a.length):"Home"===r.key?(r.preventDefault(),i=0):"End"===r.key&&(r.preventDefault(),i=a.length-1),i>=0&&(a[i].focus(),t(a[i],a,o,e))})})})}(),document.querySelectorAll(".podcast20-chapters-list").forEach(function(t){const o=t.closest(".rss-episode-player");if(!o)return void console.warn("PodLoom: Chapter list found but no episode container");const r=o.querySelector("audio");if(!r)return void console.warn("PodLoom: Chapter list found but no audio player in episode container");const n=o.querySelector(".rss-episode-artwork img");n&&(n.hasAttribute("data-original-src")||n.setAttribute("data-original-src",n.src)),t.querySelectorAll(".chapter-item").forEach(function(o){function n(n){if("A"===n.target.tagName&&n.target.classList.contains("chapter-external-link"))return;if(n.target.closest(".chapter-external-link"))return;n.preventDefault();const i=parseFloat(o.getAttribute("data-start-time"));isNaN(i)||(r.currentTime=i,r.paused&&r.play().catch(function(t){console.warn("PodLoom: Could not auto-play audio:",t)}),a(t,i),e("Playing chapter: "+(o.querySelector(".chapter-title")?.textContent||"")))}o.style.cursor="pointer",o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.addEventListener("click",n),o.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),n(t))})}),r.addEventListener("timeupdate",function(){const e=r.currentTime;a(t,e)})}),document.querySelectorAll(".transcript-format-button").forEach(function(t){t.setAttribute("aria-expanded","false"),t.addEventListener("click",function(){const e=t.closest(".podcast20-transcripts").querySelector(".transcript-viewer"),a=e.querySelector(".transcript-content");if(t.classList.contains("active"))return t.classList.remove("active"),t.setAttribute("aria-expanded","false"),e.style.display="none",void(a.innerHTML="");let r;try{const e=t.getAttribute("data-transcripts");r=JSON.parse(e)}catch(e){r=[{url:t.getAttribute("data-url"),type:t.getAttribute("data-type")||"text/plain"}]}t.classList.add("loading"),t.setAttribute("aria-busy","true"),e.style.display="block",e.setAttribute("aria-busy","true"),a.innerHTML='<div class="transcript-loading" role="status">Loading transcript...</div>',o(r,0,t,a)})}),document.querySelectorAll(".transcript-close").forEach(function(t){t.addEventListener("click",function(){const e=t.closest(".transcript-viewer"),a=t.closest(".podcast20-transcripts").querySelector(".transcript-format-button"),o=e.querySelector(".transcript-content");a.classList.remove("active"),a.setAttribute("aria-expanded","false"),e.style.display="none",o.innerHTML="",a.focus()})}),document.querySelectorAll(".podloom-skip-btn").forEach(function(t){t.hasAttribute("data-initialized")||(t.setAttribute("data-initialized","true"),t.addEventListener("click",function(){var e=parseInt(t.getAttribute("data-skip"),10),a=t.closest(".rss-episode-player");if(a){var o=a.querySelector("audio");if(o){var r=o.currentTime+e;r=Math.max(0,Math.min(r,o.duration||1/0)),o.currentTime=r}}}))}),p(),u(),document.querySelectorAll(".podloom-player-container").forEach(function(t){if(!t.hasAttribute("data-player-initialized")){t.setAttribute("data-player-initialized","true");var e=t.querySelector(".podloom-audio-element");if(e){e.setAttribute("aria-hidden","true"),e.removeAttribute("controls"),e.setAttribute("tabindex","-1"),t.podloomAudio=e;var a=t.querySelector(".podloom-play-toggle"),o=t.querySelector(".podloom-timeline-container"),r=t.querySelector(".podloom-timeline-progress"),n=t.querySelector(".podloom-timeline-slider"),i=t.querySelector(".podloom-current-time"),s=t.querySelector(".podloom-duration"),c=t.querySelector(".podloom-speed-btn"),d=[1,1.25,1.5,2],p=0;a&&a.addEventListener("click",function(){e.paused?e.play().catch(function(t){console.warn("PodLoom: Could not play audio",t)}):e.pause()}),e.addEventListener("play",function(){t.classList.add("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-pause-label")||"Pause")}),e.addEventListener("pause",function(){t.classList.remove("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-play-label")||"Play")}),e.addEventListener("ended",function(){t.classList.remove("is-playing"),a&&a.setAttribute("aria-label",a.getAttribute("data-play-label")||"Play")}),e.addEventListener("timeupdate",function(){var t=e.currentTime,a=e.duration||0;if(i&&(i.textContent=l(t)),a>0&&r){var o=t/a*100;r.style.width=o+"%"}a>0&&n&&(n.value=t)}),e.addEventListener("loadedmetadata",function(){s&&(s.textContent=l(e.duration)),n&&(n.max=e.duration)}),e.addEventListener("durationchange",function(){s&&e.duration&&isFinite(e.duration)&&(s.textContent=l(e.duration)),n&&e.duration&&isFinite(e.duration)&&(n.max=e.duration)}),n&&n.addEventListener("input",function(){var t=parseFloat(n.value);isNaN(t)||(e.currentTime=t)}),o&&o.addEventListener("click",function(t){var a=o.getBoundingClientRect(),r=(t.clientX-a.left)/a.width*(e.duration||0);!isNaN(r)&&isFinite(r)&&(e.currentTime=r)}),c&&c.addEventListener("click",function(){var t=d[p=(p+1)%d.length];e.playbackRate=t,c.textContent=t+"x"})}}}),document.querySelectorAll(".podloom-player-container:not(.podloom-ready), .rss-playlist-player:not(.podloom-ready)").forEach(function(t){t.classList.add("podloom-ready")}),setTimeout(m,500)}if("loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f(),void 0!==window.MutationObserver){new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&t.addedNodes.forEach(function(t){1===t.nodeType&&(t.classList&&(t.classList.contains("podcast20-tabs")||t.classList.contains("podcast20-chapters-list")||t.classList.contains("rss-playlist-player")||t.classList.contains("podloom-player-container"))||t.querySelector&&(t.querySelector(".podcast20-tabs")||t.querySelector(".podcast20-chapters-list")||t.querySelector(".rss-playlist-player")||t.querySelector(".podloom-player-container")))&&f()})})}).observe(document.body,{childList:!0,subtree:!0})}function h(t){"podloomNodeInserted"===t.animationName&&(t.target.classList.contains("podloom-ready")||f())}document.addEventListener("animationstart",h,!1),document.addEventListener("webkitAnimationStart",h,!1)}();