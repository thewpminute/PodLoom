!function(){const{registerBlockType:e}=wp.blocks,{InspectorControls:o,useBlockProps:t}=wp.blockEditor,{PanelBody:l,SelectControl:a,RadioControl:n,ToggleControl:p,ColorPicker:r,Placeholder:s,Spinner:c,Button:d}=wp.components,{useState:m,useEffect:i}=wp.element,{__:u}=wp.i18n;e("podloom/subscribe-buttons",{title:u("PodLoom Subscribe Buttons","podloom-podcast-player"),icon:"share",category:"media",attributes:{source:{type:"string",default:""},iconSize:{type:"string",default:"medium"},colorMode:{type:"string",default:"brand"},customColor:{type:"string",default:"#000000"},layout:{type:"string",default:"horizontal"},showLabels:{type:"boolean",default:!1}},edit:function({attributes:e,setAttributes:b}){const{source:y,iconSize:w,colorMode:h,customColor:g,layout:f,showLabels:E}=e,[v,S]=m([]),[x,_]=m(!0),[C,L]=m(null),[k,P]=m(!1),D=t();i(()=>{z()},[]),i(()=>{y?B(y):L(null)},[y,h,g]);const z=async()=>{_(!0);try{const e=new FormData;e.append("action","podloom_get_subscribe_podcasts"),e.append("nonce",podloomData.nonce);const o=await fetch(podloomData.ajaxUrl,{method:"POST",body:e}),t=await o.json();t.success&&S(t.data.podcasts||[])}catch(e){console.error("Error loading podcasts:",e)}finally{_(!1)}},B=async e=>{P(!0);try{const o=new FormData;o.append("action","podloom_get_subscribe_preview"),o.append("nonce",podloomData.nonce),o.append("source_id",e),o.append("color_mode",h),"custom"===h&&o.append("custom_color",g);const t=await fetch(podloomData.ajaxUrl,{method:"POST",body:o}),l=await t.json();l.success?L(l.data.links||[]):L([])}catch(e){console.error("Error loading preview:",e),L([])}finally{P(!1)}};return x?wp.element.createElement("div",D,wp.element.createElement(s,{icon:"share",label:u("PodLoom Subscribe Buttons","podloom-podcast-player")},wp.element.createElement(c),wp.element.createElement("p",null,u("Loading podcasts...","podloom-podcast-player")))):0===v.length?wp.element.createElement("div",D,wp.element.createElement(s,{icon:"share",label:u("PodLoom Subscribe Buttons","podloom-podcast-player")},wp.element.createElement("p",null,u("No podcasts configured. Add a Transistor API key or RSS feed first.","podloom-podcast-player")),wp.element.createElement(d,{variant:"primary",href:podloomData.ajaxUrl.replace("/wp-admin/admin-ajax.php","")+"/wp-admin/admin.php?page=podloom-settings"},u("Go to Settings","podloom-podcast-player")))):wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(o,null,wp.element.createElement(l,{title:u("Subscribe Settings","podloom-podcast-player"),initialOpen:!0},wp.element.createElement(a,{label:u("Select Podcast","podloom-podcast-player"),value:y,options:(()=>{const e=[{label:u("-- Select a podcast --","podloom-podcast-player"),value:""}],o=v.filter(e=>"transistor"===e.type),t=v.filter(e=>"rss"===e.type);return o.length>0&&(e.push({label:u("━━ Transistor.fm ━━","podloom-podcast-player"),value:"__transistor_header__",disabled:!0}),o.forEach(o=>{e.push({label:"  "+o.name,value:o.source_id})})),t.length>0&&(e.push({label:u("━━ RSS Feeds ━━","podloom-podcast-player"),value:"__rss_header__",disabled:!0}),t.forEach(o=>{e.push({label:"  "+o.name,value:o.source_id})})),e})(),onChange:e=>b({source:e}),help:u("Choose which podcast to display subscribe buttons for","podloom-podcast-player")}),wp.element.createElement(n,{label:u("Icon Size","podloom-podcast-player"),selected:w,options:[{label:u("Small (24px)","podloom-podcast-player"),value:"small"},{label:u("Medium (32px)","podloom-podcast-player"),value:"medium"},{label:u("Large (48px)","podloom-podcast-player"),value:"large"}],onChange:e=>b({iconSize:e})}),wp.element.createElement(n,{label:u("Color Mode","podloom-podcast-player"),selected:h,options:[{label:u("Brand Colors","podloom-podcast-player"),value:"brand"},{label:u("Monochrome","podloom-podcast-player"),value:"mono"},{label:u("Custom Color","podloom-podcast-player"),value:"custom"}],onChange:e=>b({colorMode:e})}),"custom"===h&&wp.element.createElement("div",{style:{marginTop:"12px"}},wp.element.createElement(r,{color:g,onChange:e=>b({customColor:e}),enableAlpha:!1})),wp.element.createElement(n,{label:u("Layout","podloom-podcast-player"),selected:f,options:[{label:u("Horizontal","podloom-podcast-player"),value:"horizontal"},{label:u("Vertical","podloom-podcast-player"),value:"vertical"},{label:u("Grid","podloom-podcast-player"),value:"grid"}],onChange:e=>b({layout:e})}),wp.element.createElement(p,{label:u("Show Labels","podloom-podcast-player"),checked:E,onChange:e=>b({showLabels:e}),help:u("Display platform names next to icons","podloom-podcast-player")}))),wp.element.createElement("div",D,y?k?wp.element.createElement("div",{style:{padding:"20px",textAlign:"center"}},wp.element.createElement(c),wp.element.createElement("p",null,u("Loading preview...","podloom-podcast-player"))):wp.element.createElement("div",{className:"wp-block-podloom-subscribe-buttons"},(()=>{if(!C||0===C.length)return wp.element.createElement("div",{style:{padding:"20px",textAlign:"center",color:"#666"}},u("No subscribe links configured for this podcast.","podloom-podcast-player"));const e=(()=>{switch(w){case"small":return 24;case"large":return 48;default:return 32}})(),o={display:"flex",flexWrap:"wrap",gap:E?"12px":"8px",alignItems:"center",justifyContent:"horizontal"===f?"flex-start":"center",flexDirection:"vertical"===f?"column":"row"},t={display:"flex",alignItems:"center",gap:"8px",textDecoration:"none",color:"inherit"},l={width:e+"px",height:e+"px",display:"flex",alignItems:"center",justifyContent:"center"};return wp.element.createElement("div",{className:"podloom-subscribe-buttons podloom-subscribe-buttons--"+f,style:o},C.map((e,o)=>wp.element.createElement("a",{key:o,href:e.url,target:"_blank",rel:"noopener noreferrer",style:t,title:e.name},wp.element.createElement("span",{style:l,dangerouslySetInnerHTML:{__html:e.svg||""}}),E&&wp.element.createElement("span",{style:{fontSize:"14px"}},e.name))))})()):wp.element.createElement(s,{icon:"share",label:u("PodLoom Subscribe Buttons","podloom-podcast-player")},wp.element.createElement("p",null,u("Select a podcast from the sidebar to display subscribe buttons.","podloom-podcast-player")))))},save:function(){return null}})}();